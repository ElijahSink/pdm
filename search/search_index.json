{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction # PDM is a modern Python package manager with PEP 582 support. It installs and manages packages in a similar way to npm that doesn't need to create a virtualenv at all! Feature highlights # PEP 582 local package installer and runner, no virtualenv involved at all. Simple and relatively fast dependency resolver, mainly for large binary distributions. A PEP 517 build backend. PEP 621 project metadata. Installation # PDM requires Python 3.7+ to be installed. It works on multiple platforms including Windows, Linux and MacOS. Note There is no restriction about what Python version your project is using, but installing PDM itself needs Python 3.7+. Recommended installation method # PDM requires python version 3.7 or higher. Like Pip, PDM provides an installation script that will install PDM into an isolated environment. For Linux/Mac 1 curl -sSL https://raw.githubusercontent.com/pdm-project/pdm/main/install-pdm.py | python - For Windows 1 ( Invoke-WebRequest -Uri https :// raw . githubusercontent . com / pdm-project / pdm / main / install-pdm . py -UseBasicParsing ). Content | python - The installer will install PDM into the user site and the location depends on the system: $HOME/.local/bin for Unix %APPDATA%\\Python\\Scripts on Windows You can pass additional options to the script to control how PDM is installed: 1 2 3 4 5 6 7 8 9 10 usage: install-pdm.py [-h] [-v VERSION] [--prerelease] [--remove] [-p PATH] [-d DEP] optional arguments: -h, --help show this help message and exit -v VERSION, --version VERSION | envvar: PDM_VERSION Specify the version to be installed, or HEAD to install from the main branch --prerelease | envvar: PDM_PRERELEASE Allow prereleases to be installed --remove | envvar: PDM_REMOVE Remove the PDM installation -p PATH, --path PATH | envvar: PDM_HOME Specify the location to install PDM -d DEP, --dep DEP | envvar: PDM_DEPS Specify additional dependencies, can be given multiple times You can either pass the options after the script or set the env var value. Other installation methods # If your are on MacOS and using homebrew , install it by: 1 $ brew install pdm If you are on Windows and using Scoop , install it by: 1 2 PS> scoop bucket add frostming https://github.com/frostming/scoop-frostming.git PS> scoop install pdm Otherwise, to avoid messing up with the system Python environment, the most recommended way to install PDM is via pipx : 1 $ pipx install pdm Or you can install PDM into the user site with pip : 1 $ pip install --user pdm Install the head version of GitHub repository: 1 $ pipx install git+https://github.com/pdm-project/pdm.git@main#egg = pdm Make sure you have installed Git LFS on your system. Enable PEP 582 globally # To make the Python interpreters aware of PEP 582 packages, one need to add the pdm/pep582/sitecustomize.py to the Python library search path. For Windows users # One just needs to execute pdm --pep582 , then environment variable will be changed automatically. Don't forget to restart the terminal session to take effect. For Mac and Linux users # The command to change the environment variables can be produced by pdm --pep582 [<SHELL>] . If <SHELL> isn't given, PDM will pick one based on some guesses. You may want to write a line in your .bash_profile (or similar profiles) to make it effective when login. For example, in bash you can do this: 1 $ pdm --pep582 >> ~/.bash_profile Once again, Don't forget to restart the terminal session to take effect. Use the docker image # PDM also provides a docker image to ease your deployment flow, to use it, write a Dockerfile with following content: 1 2 3 4 5 6 FROM frostming/pdm COPY . /app # -- Replace with the correct path to your app's main executable CMD [ \"pdm\" , \"run\" , \"python\" , \"main.py\" ] Shell Completion # PDM supports generating completion scripts for Bash, Zsh, Fish or Powershell. Here are some common locations for each shell: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Bash $ pdm completion bash > /etc/bash_completion.d/pdm.bash-completion # Zsh # Make sure ~/.zfunc is added to fpath, before compinit. $ pdm completion zsh > ~/.zfunc/_pdm # Oh-My-Zsh $ mkdir $ZSH_CUSTOM /plugins/pdm $ pdm completion zsh > $ZSH_CUSTOM /plugins/pdm/_pdm # Then make sure pdm plugin is enabled in ~/.zshrc # Fish $ pdm completion fish > ~/.config/fish/completions/pdm.fish # Powershell # Create a directory to store completion scripts PS > mkdir $PROFILE \\. . \\C ompletions PS > echo @ ' Get-ChildItem \"$PROFILE\\..\\Completions\\\" | ForEach-Object { . $_.FullName } ' @ | Out-File -Append -Encoding utf8 $PROFILE # Generate script PS > Set-ExecutionPolicy Unrestricted -Scope CurrentUser PS > pdm completion powershell | Out-File -Encoding utf8 $PROFILE \\. . \\C ompletions \\p dm_completion.ps1 Unicode and ANSI supports # PDM provides a fancy terminal UI with the help of ANSI characters and unicode emojis. It can turn on/off automatically depending on whether it is supported on your terminal. However, if you see any garbled characters, set env var DISABLE_UNICODE_OUTPUT=1 to turn off it. Use with IDE # Now there are not built-in support or plugins for PEP 582 in most IDEs, you have to configure your tools manually. PDM will write and store project-wide configurations in .pdm.toml and you are recommended to add following lines in the .gitignore : 1 2 .pdm.toml __pypackages__/ PyCharm # Mark __pypackages__/<major.minor>/lib as Sources Root. Additionally, if you want to use tools from the environment (e.g. pytest ), you have to add the __pypackages__/<major.minor>/bin directory to the PATH variable in the corresponding run/debug configuration. VSCode # Add the following to .vscode/settings.json : 1 2 3 4 5 { ... \"python.autoComplete.extraPaths\" : [ \"__pypackages__/<major.minor>/lib\" ], \"python.analysis.extraPaths\" : [ \"__pypackages__/<major.minor>/lib\" ] } Enable PEP582 globally , and make sure VSCode runs using the same user and shell you enabled PEP582 for. Cannot enable PEP582 globally? If for some reason you cannot enable PEP582 globally, you can still configure each \"launch\" in each project: set the PYTHONPATH environment variable in your launch configuration, in .vscode/launch.json . For example, to debug your pytest run: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"version\" : \"0.2.0\" , \"configurations\" : [ { \"name\" : \"pytest\" , \"type\" : \"python\" , \"request\" : \"launch\" , \"module\" : \"pytest\" , \"args\" : [ \"tests\" ], \"justMyCode\" : false , \"env\" : { \"PYTHONPATH\" : \"__pypackages__/<major.minor>/lib\" } } ] } If your package resides in a src directory, add it to PYTHONPATH as well: 1 \"env\" : { \"PYTHONPATH\" : \"src:__pypackages__/<major.minor>/lib\" } Task Provider # In addition, there is a VSCode Task Provider extension available for download. This makes it possible for VSCode to automatically detect pdm scripts so they can be run natively as VSCode Tasks . Seek for other IDEs or editors # PDM Eco-system # Awesome PDM is a curated list of awesome PDM plugins and resources.","title":"Home"},{"location":"#introduction","text":"PDM is a modern Python package manager with PEP 582 support. It installs and manages packages in a similar way to npm that doesn't need to create a virtualenv at all!","title":"Introduction"},{"location":"#feature-highlights","text":"PEP 582 local package installer and runner, no virtualenv involved at all. Simple and relatively fast dependency resolver, mainly for large binary distributions. A PEP 517 build backend. PEP 621 project metadata.","title":"Feature highlights"},{"location":"#installation","text":"PDM requires Python 3.7+ to be installed. It works on multiple platforms including Windows, Linux and MacOS. Note There is no restriction about what Python version your project is using, but installing PDM itself needs Python 3.7+.","title":"Installation"},{"location":"#recommended-installation-method","text":"PDM requires python version 3.7 or higher. Like Pip, PDM provides an installation script that will install PDM into an isolated environment. For Linux/Mac 1 curl -sSL https://raw.githubusercontent.com/pdm-project/pdm/main/install-pdm.py | python - For Windows 1 ( Invoke-WebRequest -Uri https :// raw . githubusercontent . com / pdm-project / pdm / main / install-pdm . py -UseBasicParsing ). Content | python - The installer will install PDM into the user site and the location depends on the system: $HOME/.local/bin for Unix %APPDATA%\\Python\\Scripts on Windows You can pass additional options to the script to control how PDM is installed: 1 2 3 4 5 6 7 8 9 10 usage: install-pdm.py [-h] [-v VERSION] [--prerelease] [--remove] [-p PATH] [-d DEP] optional arguments: -h, --help show this help message and exit -v VERSION, --version VERSION | envvar: PDM_VERSION Specify the version to be installed, or HEAD to install from the main branch --prerelease | envvar: PDM_PRERELEASE Allow prereleases to be installed --remove | envvar: PDM_REMOVE Remove the PDM installation -p PATH, --path PATH | envvar: PDM_HOME Specify the location to install PDM -d DEP, --dep DEP | envvar: PDM_DEPS Specify additional dependencies, can be given multiple times You can either pass the options after the script or set the env var value.","title":"Recommended installation method"},{"location":"#other-installation-methods","text":"If your are on MacOS and using homebrew , install it by: 1 $ brew install pdm If you are on Windows and using Scoop , install it by: 1 2 PS> scoop bucket add frostming https://github.com/frostming/scoop-frostming.git PS> scoop install pdm Otherwise, to avoid messing up with the system Python environment, the most recommended way to install PDM is via pipx : 1 $ pipx install pdm Or you can install PDM into the user site with pip : 1 $ pip install --user pdm Install the head version of GitHub repository: 1 $ pipx install git+https://github.com/pdm-project/pdm.git@main#egg = pdm Make sure you have installed Git LFS on your system.","title":"Other installation methods"},{"location":"#enable-pep-582-globally","text":"To make the Python interpreters aware of PEP 582 packages, one need to add the pdm/pep582/sitecustomize.py to the Python library search path.","title":"Enable PEP 582 globally"},{"location":"#for-windows-users","text":"One just needs to execute pdm --pep582 , then environment variable will be changed automatically. Don't forget to restart the terminal session to take effect.","title":"For Windows users"},{"location":"#for-mac-and-linux-users","text":"The command to change the environment variables can be produced by pdm --pep582 [<SHELL>] . If <SHELL> isn't given, PDM will pick one based on some guesses. You may want to write a line in your .bash_profile (or similar profiles) to make it effective when login. For example, in bash you can do this: 1 $ pdm --pep582 >> ~/.bash_profile Once again, Don't forget to restart the terminal session to take effect.","title":"For Mac and Linux users"},{"location":"#use-the-docker-image","text":"PDM also provides a docker image to ease your deployment flow, to use it, write a Dockerfile with following content: 1 2 3 4 5 6 FROM frostming/pdm COPY . /app # -- Replace with the correct path to your app's main executable CMD [ \"pdm\" , \"run\" , \"python\" , \"main.py\" ]","title":"Use the docker image"},{"location":"#shell-completion","text":"PDM supports generating completion scripts for Bash, Zsh, Fish or Powershell. Here are some common locations for each shell: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Bash $ pdm completion bash > /etc/bash_completion.d/pdm.bash-completion # Zsh # Make sure ~/.zfunc is added to fpath, before compinit. $ pdm completion zsh > ~/.zfunc/_pdm # Oh-My-Zsh $ mkdir $ZSH_CUSTOM /plugins/pdm $ pdm completion zsh > $ZSH_CUSTOM /plugins/pdm/_pdm # Then make sure pdm plugin is enabled in ~/.zshrc # Fish $ pdm completion fish > ~/.config/fish/completions/pdm.fish # Powershell # Create a directory to store completion scripts PS > mkdir $PROFILE \\. . \\C ompletions PS > echo @ ' Get-ChildItem \"$PROFILE\\..\\Completions\\\" | ForEach-Object { . $_.FullName } ' @ | Out-File -Append -Encoding utf8 $PROFILE # Generate script PS > Set-ExecutionPolicy Unrestricted -Scope CurrentUser PS > pdm completion powershell | Out-File -Encoding utf8 $PROFILE \\. . \\C ompletions \\p dm_completion.ps1","title":"Shell Completion"},{"location":"#unicode-and-ansi-supports","text":"PDM provides a fancy terminal UI with the help of ANSI characters and unicode emojis. It can turn on/off automatically depending on whether it is supported on your terminal. However, if you see any garbled characters, set env var DISABLE_UNICODE_OUTPUT=1 to turn off it.","title":"Unicode and ANSI supports"},{"location":"#use-with-ide","text":"Now there are not built-in support or plugins for PEP 582 in most IDEs, you have to configure your tools manually. PDM will write and store project-wide configurations in .pdm.toml and you are recommended to add following lines in the .gitignore : 1 2 .pdm.toml __pypackages__/","title":"Use with IDE"},{"location":"#pycharm","text":"Mark __pypackages__/<major.minor>/lib as Sources Root. Additionally, if you want to use tools from the environment (e.g. pytest ), you have to add the __pypackages__/<major.minor>/bin directory to the PATH variable in the corresponding run/debug configuration.","title":"PyCharm"},{"location":"#vscode","text":"Add the following to .vscode/settings.json : 1 2 3 4 5 { ... \"python.autoComplete.extraPaths\" : [ \"__pypackages__/<major.minor>/lib\" ], \"python.analysis.extraPaths\" : [ \"__pypackages__/<major.minor>/lib\" ] } Enable PEP582 globally , and make sure VSCode runs using the same user and shell you enabled PEP582 for. Cannot enable PEP582 globally? If for some reason you cannot enable PEP582 globally, you can still configure each \"launch\" in each project: set the PYTHONPATH environment variable in your launch configuration, in .vscode/launch.json . For example, to debug your pytest run: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"version\" : \"0.2.0\" , \"configurations\" : [ { \"name\" : \"pytest\" , \"type\" : \"python\" , \"request\" : \"launch\" , \"module\" : \"pytest\" , \"args\" : [ \"tests\" ], \"justMyCode\" : false , \"env\" : { \"PYTHONPATH\" : \"__pypackages__/<major.minor>/lib\" } } ] } If your package resides in a src directory, add it to PYTHONPATH as well: 1 \"env\" : { \"PYTHONPATH\" : \"src:__pypackages__/<major.minor>/lib\" }","title":"VSCode"},{"location":"#task-provider","text":"In addition, there is a VSCode Task Provider extension available for download. This makes it possible for VSCode to automatically detect pdm scripts so they can be run natively as VSCode Tasks .","title":"Task Provider"},{"location":"#seek-for-other-ides-or-editors","text":"","title":"Seek for other IDEs or editors"},{"location":"#pdm-eco-system","text":"Awesome PDM is a curated list of awesome PDM plugins and resources.","title":"PDM Eco-system"},{"location":"changelog/","text":"Change Log # Release v1.7.2 (2021-07-30) # Bug Fixes # Remove the existing files before installing. #565 Deduplicate the plugins list. #566 Release v1.7.1 (2021-07-29) # Bug Fixes # Accept non-canonical distribution name in the wheel's dist-info directory name. #529 Prefer requirments with narrower version constraints or allowing prereleases to find matches. #551 Use the underlying real executable path for writing shebangs. #553 Fix a bug that extra markers cannot be extracted when combined with other markers with \"and\". #559 Fix a bug that redacted credentials in source urls get overwritten with the plain text after locking. #561 Refactor # Use installer as the wheel installer, replacing distlib . #519 Release v1.7.0 (2021-07-20) # Features & Improvements # Support showing individual fields by --<field-name> options in pdm show. When no package is given, show this project. #527 Add --freeze option to pdm list command which shows the dependencies list as pip's requirements.txt format. #531 Bug Fixes # Fix the path manipulation on Windows, now the PEP 582 path is prepended to the PYTHONPATH . #522 Fix the handling of auth prompting: will try keyring in non-verbose mode. #523 Recognize old entry point name \"pdm.plugin\" for backward-compatibility. #530 Match the VCS scheme in case-insensitive manner. #537 Use the default permission bits when writing project files. #542 Fix the VCS url to be consistent between lock and install. #547 Improved Documentation # Add installation instructions for Scoop. #522 Dependencies # Update pdm-pep517 to 0.8.0 . #524 Switch from toml to tomli . #541 Refactor # Seperate the build env into two different levels for better caching. #541 Refactor the build part into smaller functions. #543 Release v1.6.4 (2021-06-23) # Features & Improvements # Extract package name from egg-info in filename when eligible. Remove the patching code of resolvelib's inner class. #441 Support installing packages from subdiretories of VCS repository. #507 Add an install script to bootstrap PDM quickly without help of other tools. Modify docs to recommend this installation method. #508 Add a new subcommand plugin to manage pdm plugins, including add , remove and list commands. #510 Bug Fixes # Don't monkeypatch the internal class of resolvelib any more. This makes PDM more stable across updates of sub-dependencies. #515 Miscellany # Clear the type errors from mypy. #261 Release v1.6.3 (2021-06-17) # Features & Improvements # Add an option -u/--unconstrained to support unconstraining version specifiers when adding packages. #501 Bug Fixes # Fix the format of dependency arrays when a new value is appended. #487 Allow missing email attribute for authors and maintainers. #492 Fix a bug that editable install shouldn't require pyproject.toml to be valid. #497 Fix a bug on MacOS that purelib and platlib paths of isolated build envs cannot be substituted correctly if the Python is a framework build. #502 Fix the version sort of candidates. #506 Release v1.6.2 (2021-05-31) # No significant changes. Release v1.6.1 (2021-05-31) # No significant changes. Release v1.6.0 (2021-05-31) # Features & Improvements # Use a new approach to determine the packages to be installed. This requires a quick resolution step before installation. #456 pdm export no longer produces requirements file applicable for all platforms due to the new approach. #456 Add structural typing for requirements module. Refactor the requirments module for that purpose. #433 Introduce --no-editable option to install non-editable versions of all packages. #443 Introduce --no-self option to prevent the project itself from being installed. #444 Add a default .gitignore file in the __pypackages__ directory. #446 Check if the lock file version is compatible with PDM program before installation. #463 Expose the project root path via PDM_PROJECT_ROOT env var. Change to the project root when executing scripts. #470 Fix a bug that installation resolution doesn't respect the requirement markers from pyproject config. #480 Bug Fixes # Changing to multiline breaks the parsing of TOML document. #462 Fix a bug that transient dependencies of conditional requirements can't be resolved. #472 Fix a bug that invalid wheels are rejected while they are acceptable for resolution. #473 Fix a bug that build environment is not fully isolated with the hosted environment. #477 Ensure the lock file is compatible before looking for the locked candidates. #484 Improved Documentation # Fix 404 links in documentation. #472 Dependencies # Migrate from tomlkit to atoml as the style-preserving TOML parser and writer. #465 Removals and Deprecations # Remove the warning of --dev flag for older versions of PDM. #444 Miscellany # Add Python 3.10 beta CI job. #457 Release v1.5.3 (2021-05-10) # Features & Improvements # Support passing options to the build backends via --config-setting . #452 Bug Fixes # Seek for other sitecustomize.py to import. #422 Fix an unescaped single quote in fish completion script. #423 The hashes of a remote file candidate should be calculated from the link itself. #450 Dependencies # Remove keyring as a dependency and guide users to install it when it is not available. #442 Specify the minimum version of distlib . #447 Miscellany # Add log output about found candidates and their origin. #421 Add mypy pre-commit hook #427 Improve type safety of pdm.cli.actions #428 Fix wrong mypy configuration. #451 Release v1.5.2 (2021-04-27) # Features & Improvements # Allow pdm use with no argument given, which will list all available pythons for pick. #409 Bug Fixes # Inform user to enable PEP 582 for development script to work. #404 Check the existence of pyenv shim Python interpreter before using it. #406 Fix a bug that executing setup.py failed for NameError. #407 Check before setting the PYTHONPATH environment variable for PEP582 #410 Fix development setup error. #415 Dependencies # Update pip to 21.1 and fix compatibility issues. #412 Release v1.5.1 (2021-04-22) # Bug Fixes # Make func translate_sections pure to avoid exporting requirements in random order. #401 Expand the variables in install requirements' attributes for build. #402 Release v1.5.0 (2021-04-20) # Features & Improvements # Include dev dependencies by default for install and sync commands. Add a new option --prod/--production to exclude them. Improve the dependency selection logic to be more convenient to use \u2014 the more common the usage is, the shorter the command is. #391 Bug Fixes # Enquote executable path to ensure generating valid scripts. #387 Consider hashes when fetching artifact link for build. #389 Considier the sources settings when building. #399 Improved Documentation # New pdm setting source-includes to mark files to be included only in sdist builds. #390 Dependencies # Update pdm-pep517 to 0.7.0 ; update resolvelib to 0.7.0 . #390 Removals and Deprecations # Deprecate the usage of -d/--dev option in install and sync commands. #391 Release v1.5.0b1 (2021-04-12) # Features & Improvements # Improve the env builder to run in isolated mode. #384 Bug Fixes # Remove the incompatible code from the files that will be run in-process. #375 Get the correct Python ABI tag of selected interpreter #378 Error out when doing pdm run on a directory not initialized yet. Give warning message when the project automatically fallbacks to the global project. Dependencies # Upgrade resolvelib to 0.6.0 . #381 Miscellany # refactor pdm.models.readers to improve typing support #321 Add a basic integration test for cross-python check. #377 Refactor the project.python_executable to project.python that contains all info of the interpreter. #382 Continue refactoring Python info to extract to its own module. #383 Refactor the creation of project. Release v1.5.0b0 (2021-04-03) # Features & Improvements # Add hand-written zsh completion script. #188 Add a special value :all given to -s/--section to refer to all sections under the same species. Adjust add , sync , install , remove and update to support the new dev-dependencies groups. Old behavior will be kept the same. #351 dev-dependencies is now a table of dependencies groups, where key is the group name and value is an array of dependencies. These dependencies won't appear in the distribution's metadata. dev-depedencies of the old format will turn into dev group under dev-dependencies . #351 Move dev-dependencies , includes , excludes and package-dir out from [project] table to [tool.pdm] table. The migration will be done automaticaly if old format is detected. #351 Throws an error with meaningful message when no candidate is found for one requirement. #357 Support --dry-run option for update command to display packages that need update, install or removal. Add --top option to limit to top level packages only. #358 Full-featured completion scripts for Zsh and Powershell - section selection, package name autocompletion and so on. Windows is a first-class citizen! #367 Support non-interactive init command via -n/--non-interactive option. No question will be asked in this mode. #368 Show project packages path(PEP 582) in the output of pdm info , also add an option --packages to show that value only. #372 Bug Fixes # Fix a bug that pure python libraries are not loaded to construct the WorkingSet. #346 Don't write <script>-X.Y variant to the bin folder. #365 Python is now run in isolated mode via subprocess to avoid accidentally importing user packages. #369 Don't overwrite existing dependencies when importing from requirements.txt. #370 Improved Documentation # Add instructions of how to integrate PDM with Emacs, contributed by @linw1995. #372 Removals and Deprecations # Remove the support of project path following -g/--global that was deprecated in 1.4.0 . One should use -g -p <project_path> for that purpose. #361 Miscellany # Add test coverage to PDM. #109 Add type annotations into untyped functions to start using mypy. #354 Refactor the format converter code to be more explicit. #360 Release v1.4.5 (2021-03-30) # Features & Improvements # Skip the first prompt of pdm init #352 Bug Fixes # Fix a test failure when using homebrew installed python. #348 Get revision from the VCS URL if source code isn't downloaded to local. #349 Dependencies # Update dependency pdm-pep517 to 0.6.1 . #353 Release v1.4.4 (2021-03-27) # Features & Improvements # Emit warning if version or description can't be retrieved when importing from flit metadata. #342 Add type argument to pdm cache clear and improve its UI. #343 Always re-install the editable packages when syncing the working set. This can help tracking the latest change of entry-points . #344 Bug Fixes # Make installer quit early if a wheel isn't able to build. #338 Miscellany # ignore type checking in models.project_info.ProjectInfo , which indexes distlib.metadata._data #335 Release v1.4.3 (2021-03-24) # Features & Improvements # Change the group name of entry points from pdm.plugins to pdm . Export some useful objects and models for shorter import path. #318 Field cmd in tools.pdm.scripts configuration items now allows specifying an argument array instead of a string. Refactor: Remove the reference of stream singleton, improve the UI related code. #320 Support dependencies managed by poetry and flit being installed as editable packages. #324 Refactor: Extract the logic of finding interpreters to method for the sake of subclass overriding. #326 Complete the cache command, add list , remove and info subcommands. #329 Refactor: Unify the code about selecting interpreter to reduce the duplication. #331 Retrieve the version and description of a flit project by parsing the AST of the main file. #333 Bug Fixes # Fix a parsing error when non-ascii characters exist in pyproject.toml . #308 Fix a bug that non-editable VCS candidates can't satisfy their requirements once locked in the lock file. #314 Fix a bug of import-on-init that fails when requirements.txt is detected. #328 Miscellany # refactor pdm.iostream to improve 'typing' support #301 fix some typos #323 Release v1.4.2 (2021-03-18) # Features & Improvements # Refactor the code, extract the version related logic from specifiers.py to a separated module. #303 Bug Fixes # Fix a bug that get_dependencies() returns error when the setup.py has no intall_requires key. #299 Pin the VCS revision for non-editable VCS candidates in the lock file. #305 Fix a bug that editable build hits the cached wheel unexpectedly. #307 Miscellany # replace 'typing comments' with type annotations throughout #298 Release v1.4.1 (2021-03-12) # Features & Improvements # Support importing dependencies from requirements.txt to dev-dependencies or sections. #291 Bug Fixes # Fallback to static parsing when building was failed to find the dependencies of a candidate. #293 Fix a bug that pdm init fails when pyproject.toml exists but has no [project] section. #295 Improved Documentation # Document about how to use PDM with Nox. #281 Release v1.4.0 (2021-03-05) # Features & Improvements # When -I/--ignore-python passed or PDM_IGNORE_SAVED_PYTHON=1 , ignore the interpreter set in .pdm.toml and don't save to it afterwards. #283 A new option -p/--project is introduced to specify another path for the project base. It can also be combined with -g/--global option. The latter is changed to a flag only option that does not accept values. #286 Support -f setuppy for pdm export to export the metadata as setup.py #289 Bug Fixes # Fix a bug that editable local package requirements cannot be parsed rightly. #285 Change the priority of metadata files to parse so that PEP 621 metadata will be parsed first. #288 Improved Documentation # Add examples of how to integrate with CI pipelines (and tox). #281 Release v1.3.4 (2021-03-01) # Improved Documentation # added documentation on a task provider for vscode #280 Bug Fixes # Ignore the python requires constraints when fetching the link from the PyPI index. Release v1.3.3 (2021-02-26) # Bug Fixes # Fix the requirement string of a VCS requirement to comply with PEP 508. #275 Fix a bug that editable packages with src directory can't be uninstalled correctly. #277 Fix a bug that editable package doesn't override the non-editable version in the working set. #278 Release v1.3.2 (2021-02-25) # Features & Improvements # Abort and tell user the selected section following pdm sync or pdm install is not present in the error message. #274 Bug Fixes # Fix a bug that candidates' sections cannot be retrieved rightly when circular dependencies exist. #270 Don't pass the help argument into the run script method. #272 Release v1.3.1 (2021-02-19) # Bug Fixes # Use the absolute path when importing from a Poetry pyproject.toml. #262 Fix a bug that old toml table head is kept when converting to PEP 621 metadata format. #263 Postpone the evaluation of requires-python attribute when fetching the candidates of a package. #264 Release v1.3.0 (2021-02-09) # Features & Improvements # Increase the default value of the max rounds of resolution to 1000, make it configurable. #238 Rewrite the project's egg-info directory when dependencies change. So that pdm list --graph won't show invalid entries. #240 When importing requirments from a requirments.txt file, build the package to find the name if not given in the URL. #245 When initializing the project, prompt user for whether the project is a library, and give empty name and version if not. #253 Bug Fixes # Fix the version validator of wheel metadata to align with the implementation of packaging . #130 Preserve the sections value of a pinned candidate to be reused. #234 Strip spaces in user input when prompting for the python version to use. #252 Fix the version parsing of Python requires to allow > , >= , < , <= to combine with star versions. #254 Release v1.2.0 (2021-01-26) # Features & Improvements # Change the behavior of --save-compatible slightly. Now the version specifier saved is using the REAL compatible operator ~= as described in PEP 440. Before: requests<3.0.0,>=2.19.1 , After: requests~=2.19 . The new specifier accepts requests==2.19.0 as compatible version. #225 Environment variable ${PROJECT_ROOT} in the dependency specification can be expanded to refer to the project root in pyproject.toml. The environment variables will be kept as they are in the lock file. #226 Change the dependencies of a package in the lock file to a list of PEP 508 strings #236 Bug Fixes # Ignore user's site and PYTHONPATH (with python -I mode) when executing pip commands. #231 Improved Documentation # Document about how to activate and use a plugin. #227 Dependencies # Test project on pip 21.0 . #235 Release v1.1.0 (2021-01-18) # Features & Improvements # Allow users to hide secrets from the pyproject.toml . Dynamically expand env variables in the URLs in dependencies and indexes. Ask whether to store the credentials provided by the user. A user-friendly error will show when credentials are not provided nor correct. #198 Use a different package dir for 32-bit installation(Windows). #212 Auto disable PEP 582 when a venv-like python is given as the interpreter path. #219 Support specifying Python interpreter by pdm use <path-to-python-root> . #221 Bug Fixes # Fix a bug of PYTHONPATH manipulation under Windows platform. #215 Removals and Deprecations # Remove support of the old PEP 517 backend API path. #217 Release v1.0.0 (2021-01-05) # Bug Fixes # Correctly build wheels for dependencies with build-requirements but without a specified build-backend #213 Release v1.0.0b2 (2020-12-29) # Features & Improvements # Fallback to pypi.org when /search endpoint is not available on given index. #211 Bug Fixes # Fix a bug that PDM fails to parse python version specifiers with more than 3 parts. #210 Release v1.0.0b0 (2020-12-24) # Features & Improvements # Fully support of PEP 621 specification. Old format is deprecated at the same time. PDM will migrate the project file for you when old format is detected. Other metadata formats( Poetry , Pipfile , flit ) can also be imported as PEP 621 metadata. #175 Re-implement the pdm search to query the /search HTTP endpoint. #195 Reuse the cached built wheels to accelerate the installation. #200 Make update strategy and save strategy configurable in pdm config. #202 Improve the error message to give more insight on what to do when resolution fails. #207 Set classifiers dynamic in pyproject.toml template for autogeneration. #209 Bug Fixes # Fix a bug that distributions are not removed clearly in parallel mode. #204 Fix a bug that python specifier is_subset() returns incorrect result. #206 Release v0.12.3 (2020-12-21) # Dependencies # Pin pdm-pep517 to <0.3.0 , this is the last version to support legacy project metadata format. Release v0.12.2 (2020-12-17) # Features & Improvements # Update the lock file schema, move the file hashes to [metadata.files] table. #196 Retry failed jobs when syncing packages. #197 Removals and Deprecations # Drop pip-shims package as a dependency. #132 Miscellany # Fix the cache path for CI. #199 Release v0.12.1 (2020-12-14) # Features & Improvements # Provide an option to export requirements from pyproject.toml #190 For Windows users, pdm --pep582 can enable PEP 582 globally by manipulating the WinReg. #191 Bug Fixes # Inject __pypackages__ into PATH env var during pdm run . #193 Release v0.12.0 (2020-12-08) # Features & Improvements # Improve the user experience of pdm run : Add a special key in tool.pdm.scripts that holds configurations shared by all scripts. Support loading env var from a dot-env file. Add a flag -s/--site-packages to include system site-packages when running. #178 Now PEP 582 can be enabled in the Python interpreter directly! #181 Bug Fixes # Ensure setuptools is installed before invoking editable install script. #174 Require wheel not wheels for global projects #182 Write a sitecustomize.py instead of a .pth file to enable PEP 582. Thanks @Aloxaf. Update get_package_finder() to be compatible with pip 20.3 . #185 Fix the help messages of commands \"cache\" and \"remove\" #187 Release v0.11.0 (2020-11-20) # Features & Improvements # Support custom script shortcuts in pyproject.toml . Support custom script shortcuts defined in [tool.pdm.scripts] section. Add pdm run --list/-l to show the list of script shortcuts. #168 Patch the halo library to support parallel spinners. Change the looking of pdm install . #169 Bug Fixes # Fix a bug that package's marker fails to propagate to its grandchildren if they have already been resolved. #170 Fix a bug that bare version specifiers in Poetry project can't be converted correctly. #172 Fix the build error that destination directory is not created automatically. #173 Release v0.10.2 (2020-11-05) # Bug Fixes # Building editable distribution does not install build-system.requires anymore. #167 Release v0.10.1 (2020-11-04) # Bug Fixes # Switch the PEP 517 build frontend from build to a home-grown version. #162 Synchronize the output of LogWrapper . #164 Fix a bug that is_subset and is_superset may return wrong result when wildcard excludes overlaps with the upper bound. #165 Release v0.10.0 (2020-10-20) # Features & Improvements # Change to Git style config command. #157 Add a command to generate scripts for autocompletion, which is backed by pycomplete . #159 Bug Fixes # Fix a bug that sitecustomize.py incorrectly gets injected into the editable console scripts. #158 Release v0.9.2 (2020-10-13) # Features & Improvements # Cache the built wheels to accelerate resolution and installation process. #153 Bug Fixes # Fix a bug that no wheel is matched when finding candidates to install. #155 Fix a bug that installation in parallel will cause encoding initialization error on Ubuntu. #156 Release v0.9.1 (2020-10-13) # Features & Improvements # Display plain text instead of spinner bar under verbose mode. #150 Bug Fixes # Fix a bug that the result of find_matched() is exhausted when accessed twice. #149 Release v0.9.0 (2020-10-08) # Features & Improvements # Allow users to combine several dependency sections to form an extra require. #131 Split the PEP 517 backend to its own(battery included) package. #134 Add a new option to list command to show reverse dependency graph. #137 Bug Fixes # Fix a bug that spaces in path causes requirement parsing error. #138 Fix a bug that requirement's python constraint is not respected when resolving. #141 Dependencies # Update pdm-pep517 to 0.2.0 that supports reading version from SCM. #146 Miscellany # Add Python 3.9 to the CI version matrix to verify. #144 Release v0.8.7 (2020-09-04) # Bug Fixes # Fix a compatibility issue with wheel==0.35 . #135 Release v0.8.6 (2020-07-09) # Bug Fixes # Fix a bug that extra sources are not respected when fetching distributions. #127 Release v0.8.5 (2020-06-24) # Bug Fixes # Fix a bug that pdm export fails when the project doesn't have name property. #126 Dependencies # Upgrade dependency pip to 20.1 . #125 Release v0.8.4 (2020-05-21) # Features & Improvements # Add a new command export to export to alternative formats. #117 Miscellany # Add Dockerfile and pushed to Docker Hub. #122 Release v0.8.3 (2020-05-15) # Bug Fixes # Fix the version constraint parsing of wheel metadata. #120 Release v0.8.2 (2020-05-03) # Bug Fixes # Update resolvers to resolvelib 0.4.0. #118 Release v0.8.1 (2020-04-22) # Dependencies # Switch to upstream resolvelib 0.3.0 . #116 Release v0.8.0 (2020-04-20) # Features & Improvements # Add a new command to search for packages #111 Add show command to show package metadata. #114 Bug Fixes # Fix a bug that environment markers cannot be evaluated correctly if extras are connected with \"or\". #107 Don't consult PyPI JSON API by default for package metadata. #112 Eliminate backslashes in markers for TOML documents. #115 Release v0.7.1 (2020-04-13) # Bug Fixes # Editable packages requires setuptools to be installed in the isolated environment. Release v0.7.0 (2020-04-12) # Features & Improvements # Disable loading of site-packages under PEP 582 mode. #100 Bug Fixes # Fix a bug that TOML parsing error is not correctly captured. #101 Fix a bug of building wheels with C extensions that the platform in file name is incorrect. #99 Release v0.6.5 (2020-04-07) # Bug Fixes # Unix style executable script suffix is missing. Release v0.6.4 (2020-04-07) # Features & Improvements # Update shebang lines in the executable scripts when doing pdm use . #96 Auto-detect commonly used venv directories. #97 Release v0.6.3 (2020-03-30) # Bug Fixes # Fix a bug of moving files across different file system. #95 Release v0.6.2 (2020-03-29) # Bug Fixes # Validate user input for python_requires when initializing project. #89 Ensure wheel package is available before building packages. #90 Fix an issue of remove command that will unexpectedly uninstall packages in default section. #92 Dependencies # Update dependencies pythonfinder , python-cfonts , pip-shims and many others. Drop dependency vistir . #89 Release v0.6.1 (2020-03-25) # Features & Improvements # Redirect output messages to log file for installation and locking. #84 Bug Fixes # Fix a bug that parallel installation fails due to setuptools reinstalling. #83 Release v0.6.0 (2020-03-20) # Features & Improvements # Support specifying build script for C extensions. #23 Add test cases for pdm build . #81 Make it configurable whether to consult PyPI JSON API since it may be not trustable. Support parallel installation. Add new command pmd import to import project metadata from Pipfile , poetry , flit , requirements.txt . #79 pdm init and pdm install will auto-detect possible files that can be imported. Bug Fixes # Fix wheel builds when package_dir is mapped. #81 pdm init will use the current directory rather than finding the parents when global project is not activated. Release v0.5.0 (2020-03-14) # Features & Improvements # Introduce a super easy-to-extend plug-in system to PDM. #75 Improved Documentation # Documentation on how to write a plugin. #75 Bug Fixes # Fix a typo in metadata parsing from plugins to entry_points Release v0.4.2 (2020-03-13) # Features & Improvements # Refactor the CLI part, switch from click to argparse , for better extensibility. #73 Allow users to configure to install packages into venv when it is activated. #74 Release v0.4.1 (2020-03-11) # Features & Improvements # Add a minimal dependency set for global project. #72 Release v0.4.0 (2020-03-10) # Features & Improvements # Global project support Add a new option -g/--global to manage global project. The default location is at ~/.pdm/global-project . Use the virtualenv interpreter when detected inside an activated venv. Add a new option -p/--project to select project root other than the default one. #30 Add a new command pdm config del to delete an existing config item. #71 Bug Fixes # Fix a URL parsing issue that username will be dropped in the SSH URL. #68 Improved Documentation # Add docs for global project and selecting project path. #30 Release v0.3.2 (2020-03-08) # Features & Improvements # Display all available Python interpreters if users don't give one in pdm init . #67 Bug Fixes # Regard 4.0 as infinite upper bound when checking subsetting. #66 Release v0.3.1 (2020-03-07) # Bug Fixes # Fix a bug that ImpossiblePySpec 's hash clashes with normal one. Release v0.3.0 (2020-02-28) # Features & Improvements # Add a new command pdm config to inspect configurations. #26 Add a new command pdm cache clear to clean caches. #63 Bug Fixes # Correctly show dependency graph when circular dependencies exist. #62 Improved Documentation # Write the initial documentation for PDM. #14 Release v0.2.6 (2020-02-25) # Features & Improvements # Improve the user interface of selecting Python interpreter. #54 Bug Fixes # Fix the wheel installer to correctly unparse the flags of console scripts. #56 Fix a bug that OS-dependent hashes are not saved. #57 Release v0.2.5 (2020-02-22) # Features & Improvements # Allow specifying Python interpreter via --python option in pdm init . #49 Set python_requires when initializing and defaults to >={current_version} . #50 Bug Fixes # Always consider wheels before tarballs; correctly merge markers from different parents. #47 Filter out incompatible wheels when installing. #48 Release v0.2.4 (2020-02-21) # Bug Fixes # Use the project local interpreter to build wheels. #43 Correctly merge Python specifiers when possible. #4 Release v0.2.3 (2020-02-21) # Bug Fixes # Fix a bug that editable build generates a malformed setup.py . Release v0.2.2 (2020-02-20) # Features & Improvements # Add a fancy greeting banner when user types pdm --help . #42 Bug Fixes # Fix the RECORD file in built wheel. #41 Dependencies # Add dependency python-cfonts to display banner. #42 Release v0.2.1 (2020-02-18) # Bug Fixes # Fix a bug that short python_version markers can't be parsed correctly. #38 Make _editable_intall.py compatible with Py2. Release v0.2.0 (2020-02-14) # Features & Improvements # New option: pdm list --graph to show a dependency graph of the working set. #10 New option: pdm update --unconstrained to ignore the version constraint of given packages. #13 Improve the error message when project is not initialized before running commands. #19 Pinned candidates in lock file are reused when relocking during pdm install . #33 Use the pyenv interpreter value if pyenv is installed. #36 Introduce a new command pdm info to show project environment information. #9 Bug Fixes # Fix a bug that candidate hashes will be lost when reused. #11 Dependencies # Update pip to 20.0 , update pip_shims to 0.5.0 . #28 Miscellany # Add a script named setup_dev.py for the convenience to setup pdm for development. #29 Release v0.1.2 (2020-02-09) # Features # New command pdm use to switch python versions. #8 New option pdm list --graph to show a dependency graph. #10 Read metadata from lockfile when pinned candidate is reused. Release v0.1.1 (2020-02-07) # Features # Get version from the specified file. #6 Add column header to pdm list output. Release v0.1.0 (2020-02-07) # Bugfixes # Pass exit code to parent process in pdm run. Fix error handling for CLI. #19 Miscellany # Refactor the installer mocking for tests. Release v0.0.5 (2020-01-22) # Improvements # Ensure pypi index url is fetched in addition to the source settings. #3 Bugfixes # Fix an issue that leading \"c\"s are mistakenly stripped. #5 Fix an error with PEP 517 building. Release v0.0.4 (2020-01-22) # Improvements # Fix editable installation, now editable scripts can also be executed from outside! Content hash is calculated based on dependencies and sources, not other metadata. Bugfixes # Fix an issue that editable distributions can not be removed. Release v0.0.3 (2020-01-22) # Features # Add pdm init to bootstrap a project. Release v0.0.2 (2020-01-22) # Features # A complete functioning PEP 517 build backend. pdm builld command. Miscellany # Add a Chinese README Features # Add pdm init to bootstrap a project. Release v0.0.1 (2020-01-20) # Features # A dependency resolver that just works. A PEP 582 installer. PEP 440 version specifiers. PEP 508 environment markers. Running scripts with PEP 582 local packages. Console scripts are injected with local paths. A neat CLI. add, lock, list, update, remove commands. PEP 517 build backends. Continuous Integration.","title":"Change Log"},{"location":"changelog/#change-log","text":"","title":"Change Log"},{"location":"changelog/#release-v172-2021-07-30","text":"","title":"Release v1.7.2 (2021-07-30)"},{"location":"changelog/#bug-fixes","text":"Remove the existing files before installing. #565 Deduplicate the plugins list. #566","title":"Bug Fixes"},{"location":"changelog/#release-v171-2021-07-29","text":"","title":"Release v1.7.1 (2021-07-29)"},{"location":"changelog/#bug-fixes_1","text":"Accept non-canonical distribution name in the wheel's dist-info directory name. #529 Prefer requirments with narrower version constraints or allowing prereleases to find matches. #551 Use the underlying real executable path for writing shebangs. #553 Fix a bug that extra markers cannot be extracted when combined with other markers with \"and\". #559 Fix a bug that redacted credentials in source urls get overwritten with the plain text after locking. #561","title":"Bug Fixes"},{"location":"changelog/#refactor","text":"Use installer as the wheel installer, replacing distlib . #519","title":"Refactor"},{"location":"changelog/#release-v170-2021-07-20","text":"","title":"Release v1.7.0 (2021-07-20)"},{"location":"changelog/#features-improvements","text":"Support showing individual fields by --<field-name> options in pdm show. When no package is given, show this project. #527 Add --freeze option to pdm list command which shows the dependencies list as pip's requirements.txt format. #531","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_2","text":"Fix the path manipulation on Windows, now the PEP 582 path is prepended to the PYTHONPATH . #522 Fix the handling of auth prompting: will try keyring in non-verbose mode. #523 Recognize old entry point name \"pdm.plugin\" for backward-compatibility. #530 Match the VCS scheme in case-insensitive manner. #537 Use the default permission bits when writing project files. #542 Fix the VCS url to be consistent between lock and install. #547","title":"Bug Fixes"},{"location":"changelog/#improved-documentation","text":"Add installation instructions for Scoop. #522","title":"Improved Documentation"},{"location":"changelog/#dependencies","text":"Update pdm-pep517 to 0.8.0 . #524 Switch from toml to tomli . #541","title":"Dependencies"},{"location":"changelog/#refactor_1","text":"Seperate the build env into two different levels for better caching. #541 Refactor the build part into smaller functions. #543","title":"Refactor"},{"location":"changelog/#release-v164-2021-06-23","text":"","title":"Release v1.6.4 (2021-06-23)"},{"location":"changelog/#features-improvements_1","text":"Extract package name from egg-info in filename when eligible. Remove the patching code of resolvelib's inner class. #441 Support installing packages from subdiretories of VCS repository. #507 Add an install script to bootstrap PDM quickly without help of other tools. Modify docs to recommend this installation method. #508 Add a new subcommand plugin to manage pdm plugins, including add , remove and list commands. #510","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_3","text":"Don't monkeypatch the internal class of resolvelib any more. This makes PDM more stable across updates of sub-dependencies. #515","title":"Bug Fixes"},{"location":"changelog/#miscellany","text":"Clear the type errors from mypy. #261","title":"Miscellany"},{"location":"changelog/#release-v163-2021-06-17","text":"","title":"Release v1.6.3 (2021-06-17)"},{"location":"changelog/#features-improvements_2","text":"Add an option -u/--unconstrained to support unconstraining version specifiers when adding packages. #501","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_4","text":"Fix the format of dependency arrays when a new value is appended. #487 Allow missing email attribute for authors and maintainers. #492 Fix a bug that editable install shouldn't require pyproject.toml to be valid. #497 Fix a bug on MacOS that purelib and platlib paths of isolated build envs cannot be substituted correctly if the Python is a framework build. #502 Fix the version sort of candidates. #506","title":"Bug Fixes"},{"location":"changelog/#release-v162-2021-05-31","text":"No significant changes.","title":"Release v1.6.2 (2021-05-31)"},{"location":"changelog/#release-v161-2021-05-31","text":"No significant changes.","title":"Release v1.6.1 (2021-05-31)"},{"location":"changelog/#release-v160-2021-05-31","text":"","title":"Release v1.6.0 (2021-05-31)"},{"location":"changelog/#features-improvements_3","text":"Use a new approach to determine the packages to be installed. This requires a quick resolution step before installation. #456 pdm export no longer produces requirements file applicable for all platforms due to the new approach. #456 Add structural typing for requirements module. Refactor the requirments module for that purpose. #433 Introduce --no-editable option to install non-editable versions of all packages. #443 Introduce --no-self option to prevent the project itself from being installed. #444 Add a default .gitignore file in the __pypackages__ directory. #446 Check if the lock file version is compatible with PDM program before installation. #463 Expose the project root path via PDM_PROJECT_ROOT env var. Change to the project root when executing scripts. #470 Fix a bug that installation resolution doesn't respect the requirement markers from pyproject config. #480","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_5","text":"Changing to multiline breaks the parsing of TOML document. #462 Fix a bug that transient dependencies of conditional requirements can't be resolved. #472 Fix a bug that invalid wheels are rejected while they are acceptable for resolution. #473 Fix a bug that build environment is not fully isolated with the hosted environment. #477 Ensure the lock file is compatible before looking for the locked candidates. #484","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_1","text":"Fix 404 links in documentation. #472","title":"Improved Documentation"},{"location":"changelog/#dependencies_1","text":"Migrate from tomlkit to atoml as the style-preserving TOML parser and writer. #465","title":"Dependencies"},{"location":"changelog/#removals-and-deprecations","text":"Remove the warning of --dev flag for older versions of PDM. #444","title":"Removals and Deprecations"},{"location":"changelog/#miscellany_1","text":"Add Python 3.10 beta CI job. #457","title":"Miscellany"},{"location":"changelog/#release-v153-2021-05-10","text":"","title":"Release v1.5.3 (2021-05-10)"},{"location":"changelog/#features-improvements_4","text":"Support passing options to the build backends via --config-setting . #452","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_6","text":"Seek for other sitecustomize.py to import. #422 Fix an unescaped single quote in fish completion script. #423 The hashes of a remote file candidate should be calculated from the link itself. #450","title":"Bug Fixes"},{"location":"changelog/#dependencies_2","text":"Remove keyring as a dependency and guide users to install it when it is not available. #442 Specify the minimum version of distlib . #447","title":"Dependencies"},{"location":"changelog/#miscellany_2","text":"Add log output about found candidates and their origin. #421 Add mypy pre-commit hook #427 Improve type safety of pdm.cli.actions #428 Fix wrong mypy configuration. #451","title":"Miscellany"},{"location":"changelog/#release-v152-2021-04-27","text":"","title":"Release v1.5.2 (2021-04-27)"},{"location":"changelog/#features-improvements_5","text":"Allow pdm use with no argument given, which will list all available pythons for pick. #409","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_7","text":"Inform user to enable PEP 582 for development script to work. #404 Check the existence of pyenv shim Python interpreter before using it. #406 Fix a bug that executing setup.py failed for NameError. #407 Check before setting the PYTHONPATH environment variable for PEP582 #410 Fix development setup error. #415","title":"Bug Fixes"},{"location":"changelog/#dependencies_3","text":"Update pip to 21.1 and fix compatibility issues. #412","title":"Dependencies"},{"location":"changelog/#release-v151-2021-04-22","text":"","title":"Release v1.5.1 (2021-04-22)"},{"location":"changelog/#bug-fixes_8","text":"Make func translate_sections pure to avoid exporting requirements in random order. #401 Expand the variables in install requirements' attributes for build. #402","title":"Bug Fixes"},{"location":"changelog/#release-v150-2021-04-20","text":"","title":"Release v1.5.0 (2021-04-20)"},{"location":"changelog/#features-improvements_6","text":"Include dev dependencies by default for install and sync commands. Add a new option --prod/--production to exclude them. Improve the dependency selection logic to be more convenient to use \u2014 the more common the usage is, the shorter the command is. #391","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_9","text":"Enquote executable path to ensure generating valid scripts. #387 Consider hashes when fetching artifact link for build. #389 Considier the sources settings when building. #399","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_2","text":"New pdm setting source-includes to mark files to be included only in sdist builds. #390","title":"Improved Documentation"},{"location":"changelog/#dependencies_4","text":"Update pdm-pep517 to 0.7.0 ; update resolvelib to 0.7.0 . #390","title":"Dependencies"},{"location":"changelog/#removals-and-deprecations_1","text":"Deprecate the usage of -d/--dev option in install and sync commands. #391","title":"Removals and Deprecations"},{"location":"changelog/#release-v150b1-2021-04-12","text":"","title":"Release v1.5.0b1 (2021-04-12)"},{"location":"changelog/#features-improvements_7","text":"Improve the env builder to run in isolated mode. #384","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_10","text":"Remove the incompatible code from the files that will be run in-process. #375 Get the correct Python ABI tag of selected interpreter #378 Error out when doing pdm run on a directory not initialized yet. Give warning message when the project automatically fallbacks to the global project.","title":"Bug Fixes"},{"location":"changelog/#dependencies_5","text":"Upgrade resolvelib to 0.6.0 . #381","title":"Dependencies"},{"location":"changelog/#miscellany_3","text":"refactor pdm.models.readers to improve typing support #321 Add a basic integration test for cross-python check. #377 Refactor the project.python_executable to project.python that contains all info of the interpreter. #382 Continue refactoring Python info to extract to its own module. #383 Refactor the creation of project.","title":"Miscellany"},{"location":"changelog/#release-v150b0-2021-04-03","text":"","title":"Release v1.5.0b0 (2021-04-03)"},{"location":"changelog/#features-improvements_8","text":"Add hand-written zsh completion script. #188 Add a special value :all given to -s/--section to refer to all sections under the same species. Adjust add , sync , install , remove and update to support the new dev-dependencies groups. Old behavior will be kept the same. #351 dev-dependencies is now a table of dependencies groups, where key is the group name and value is an array of dependencies. These dependencies won't appear in the distribution's metadata. dev-depedencies of the old format will turn into dev group under dev-dependencies . #351 Move dev-dependencies , includes , excludes and package-dir out from [project] table to [tool.pdm] table. The migration will be done automaticaly if old format is detected. #351 Throws an error with meaningful message when no candidate is found for one requirement. #357 Support --dry-run option for update command to display packages that need update, install or removal. Add --top option to limit to top level packages only. #358 Full-featured completion scripts for Zsh and Powershell - section selection, package name autocompletion and so on. Windows is a first-class citizen! #367 Support non-interactive init command via -n/--non-interactive option. No question will be asked in this mode. #368 Show project packages path(PEP 582) in the output of pdm info , also add an option --packages to show that value only. #372","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_11","text":"Fix a bug that pure python libraries are not loaded to construct the WorkingSet. #346 Don't write <script>-X.Y variant to the bin folder. #365 Python is now run in isolated mode via subprocess to avoid accidentally importing user packages. #369 Don't overwrite existing dependencies when importing from requirements.txt. #370","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_3","text":"Add instructions of how to integrate PDM with Emacs, contributed by @linw1995. #372","title":"Improved Documentation"},{"location":"changelog/#removals-and-deprecations_2","text":"Remove the support of project path following -g/--global that was deprecated in 1.4.0 . One should use -g -p <project_path> for that purpose. #361","title":"Removals and Deprecations"},{"location":"changelog/#miscellany_4","text":"Add test coverage to PDM. #109 Add type annotations into untyped functions to start using mypy. #354 Refactor the format converter code to be more explicit. #360","title":"Miscellany"},{"location":"changelog/#release-v145-2021-03-30","text":"","title":"Release v1.4.5 (2021-03-30)"},{"location":"changelog/#features-improvements_9","text":"Skip the first prompt of pdm init #352","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_12","text":"Fix a test failure when using homebrew installed python. #348 Get revision from the VCS URL if source code isn't downloaded to local. #349","title":"Bug Fixes"},{"location":"changelog/#dependencies_6","text":"Update dependency pdm-pep517 to 0.6.1 . #353","title":"Dependencies"},{"location":"changelog/#release-v144-2021-03-27","text":"","title":"Release v1.4.4 (2021-03-27)"},{"location":"changelog/#features-improvements_10","text":"Emit warning if version or description can't be retrieved when importing from flit metadata. #342 Add type argument to pdm cache clear and improve its UI. #343 Always re-install the editable packages when syncing the working set. This can help tracking the latest change of entry-points . #344","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_13","text":"Make installer quit early if a wheel isn't able to build. #338","title":"Bug Fixes"},{"location":"changelog/#miscellany_5","text":"ignore type checking in models.project_info.ProjectInfo , which indexes distlib.metadata._data #335","title":"Miscellany"},{"location":"changelog/#release-v143-2021-03-24","text":"","title":"Release v1.4.3 (2021-03-24)"},{"location":"changelog/#features-improvements_11","text":"Change the group name of entry points from pdm.plugins to pdm . Export some useful objects and models for shorter import path. #318 Field cmd in tools.pdm.scripts configuration items now allows specifying an argument array instead of a string. Refactor: Remove the reference of stream singleton, improve the UI related code. #320 Support dependencies managed by poetry and flit being installed as editable packages. #324 Refactor: Extract the logic of finding interpreters to method for the sake of subclass overriding. #326 Complete the cache command, add list , remove and info subcommands. #329 Refactor: Unify the code about selecting interpreter to reduce the duplication. #331 Retrieve the version and description of a flit project by parsing the AST of the main file. #333","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_14","text":"Fix a parsing error when non-ascii characters exist in pyproject.toml . #308 Fix a bug that non-editable VCS candidates can't satisfy their requirements once locked in the lock file. #314 Fix a bug of import-on-init that fails when requirements.txt is detected. #328","title":"Bug Fixes"},{"location":"changelog/#miscellany_6","text":"refactor pdm.iostream to improve 'typing' support #301 fix some typos #323","title":"Miscellany"},{"location":"changelog/#release-v142-2021-03-18","text":"","title":"Release v1.4.2 (2021-03-18)"},{"location":"changelog/#features-improvements_12","text":"Refactor the code, extract the version related logic from specifiers.py to a separated module. #303","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_15","text":"Fix a bug that get_dependencies() returns error when the setup.py has no intall_requires key. #299 Pin the VCS revision for non-editable VCS candidates in the lock file. #305 Fix a bug that editable build hits the cached wheel unexpectedly. #307","title":"Bug Fixes"},{"location":"changelog/#miscellany_7","text":"replace 'typing comments' with type annotations throughout #298","title":"Miscellany"},{"location":"changelog/#release-v141-2021-03-12","text":"","title":"Release v1.4.1 (2021-03-12)"},{"location":"changelog/#features-improvements_13","text":"Support importing dependencies from requirements.txt to dev-dependencies or sections. #291","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_16","text":"Fallback to static parsing when building was failed to find the dependencies of a candidate. #293 Fix a bug that pdm init fails when pyproject.toml exists but has no [project] section. #295","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_4","text":"Document about how to use PDM with Nox. #281","title":"Improved Documentation"},{"location":"changelog/#release-v140-2021-03-05","text":"","title":"Release v1.4.0 (2021-03-05)"},{"location":"changelog/#features-improvements_14","text":"When -I/--ignore-python passed or PDM_IGNORE_SAVED_PYTHON=1 , ignore the interpreter set in .pdm.toml and don't save to it afterwards. #283 A new option -p/--project is introduced to specify another path for the project base. It can also be combined with -g/--global option. The latter is changed to a flag only option that does not accept values. #286 Support -f setuppy for pdm export to export the metadata as setup.py #289","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_17","text":"Fix a bug that editable local package requirements cannot be parsed rightly. #285 Change the priority of metadata files to parse so that PEP 621 metadata will be parsed first. #288","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_5","text":"Add examples of how to integrate with CI pipelines (and tox). #281","title":"Improved Documentation"},{"location":"changelog/#release-v134-2021-03-01","text":"","title":"Release v1.3.4 (2021-03-01)"},{"location":"changelog/#improved-documentation_6","text":"added documentation on a task provider for vscode #280","title":"Improved Documentation"},{"location":"changelog/#bug-fixes_18","text":"Ignore the python requires constraints when fetching the link from the PyPI index.","title":"Bug Fixes"},{"location":"changelog/#release-v133-2021-02-26","text":"","title":"Release v1.3.3 (2021-02-26)"},{"location":"changelog/#bug-fixes_19","text":"Fix the requirement string of a VCS requirement to comply with PEP 508. #275 Fix a bug that editable packages with src directory can't be uninstalled correctly. #277 Fix a bug that editable package doesn't override the non-editable version in the working set. #278","title":"Bug Fixes"},{"location":"changelog/#release-v132-2021-02-25","text":"","title":"Release v1.3.2 (2021-02-25)"},{"location":"changelog/#features-improvements_15","text":"Abort and tell user the selected section following pdm sync or pdm install is not present in the error message. #274","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_20","text":"Fix a bug that candidates' sections cannot be retrieved rightly when circular dependencies exist. #270 Don't pass the help argument into the run script method. #272","title":"Bug Fixes"},{"location":"changelog/#release-v131-2021-02-19","text":"","title":"Release v1.3.1 (2021-02-19)"},{"location":"changelog/#bug-fixes_21","text":"Use the absolute path when importing from a Poetry pyproject.toml. #262 Fix a bug that old toml table head is kept when converting to PEP 621 metadata format. #263 Postpone the evaluation of requires-python attribute when fetching the candidates of a package. #264","title":"Bug Fixes"},{"location":"changelog/#release-v130-2021-02-09","text":"","title":"Release v1.3.0 (2021-02-09)"},{"location":"changelog/#features-improvements_16","text":"Increase the default value of the max rounds of resolution to 1000, make it configurable. #238 Rewrite the project's egg-info directory when dependencies change. So that pdm list --graph won't show invalid entries. #240 When importing requirments from a requirments.txt file, build the package to find the name if not given in the URL. #245 When initializing the project, prompt user for whether the project is a library, and give empty name and version if not. #253","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_22","text":"Fix the version validator of wheel metadata to align with the implementation of packaging . #130 Preserve the sections value of a pinned candidate to be reused. #234 Strip spaces in user input when prompting for the python version to use. #252 Fix the version parsing of Python requires to allow > , >= , < , <= to combine with star versions. #254","title":"Bug Fixes"},{"location":"changelog/#release-v120-2021-01-26","text":"","title":"Release v1.2.0 (2021-01-26)"},{"location":"changelog/#features-improvements_17","text":"Change the behavior of --save-compatible slightly. Now the version specifier saved is using the REAL compatible operator ~= as described in PEP 440. Before: requests<3.0.0,>=2.19.1 , After: requests~=2.19 . The new specifier accepts requests==2.19.0 as compatible version. #225 Environment variable ${PROJECT_ROOT} in the dependency specification can be expanded to refer to the project root in pyproject.toml. The environment variables will be kept as they are in the lock file. #226 Change the dependencies of a package in the lock file to a list of PEP 508 strings #236","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_23","text":"Ignore user's site and PYTHONPATH (with python -I mode) when executing pip commands. #231","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_7","text":"Document about how to activate and use a plugin. #227","title":"Improved Documentation"},{"location":"changelog/#dependencies_7","text":"Test project on pip 21.0 . #235","title":"Dependencies"},{"location":"changelog/#release-v110-2021-01-18","text":"","title":"Release v1.1.0 (2021-01-18)"},{"location":"changelog/#features-improvements_18","text":"Allow users to hide secrets from the pyproject.toml . Dynamically expand env variables in the URLs in dependencies and indexes. Ask whether to store the credentials provided by the user. A user-friendly error will show when credentials are not provided nor correct. #198 Use a different package dir for 32-bit installation(Windows). #212 Auto disable PEP 582 when a venv-like python is given as the interpreter path. #219 Support specifying Python interpreter by pdm use <path-to-python-root> . #221","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_24","text":"Fix a bug of PYTHONPATH manipulation under Windows platform. #215","title":"Bug Fixes"},{"location":"changelog/#removals-and-deprecations_3","text":"Remove support of the old PEP 517 backend API path. #217","title":"Removals and Deprecations"},{"location":"changelog/#release-v100-2021-01-05","text":"","title":"Release v1.0.0 (2021-01-05)"},{"location":"changelog/#bug-fixes_25","text":"Correctly build wheels for dependencies with build-requirements but without a specified build-backend #213","title":"Bug Fixes"},{"location":"changelog/#release-v100b2-2020-12-29","text":"","title":"Release v1.0.0b2 (2020-12-29)"},{"location":"changelog/#features-improvements_19","text":"Fallback to pypi.org when /search endpoint is not available on given index. #211","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_26","text":"Fix a bug that PDM fails to parse python version specifiers with more than 3 parts. #210","title":"Bug Fixes"},{"location":"changelog/#release-v100b0-2020-12-24","text":"","title":"Release v1.0.0b0 (2020-12-24)"},{"location":"changelog/#features-improvements_20","text":"Fully support of PEP 621 specification. Old format is deprecated at the same time. PDM will migrate the project file for you when old format is detected. Other metadata formats( Poetry , Pipfile , flit ) can also be imported as PEP 621 metadata. #175 Re-implement the pdm search to query the /search HTTP endpoint. #195 Reuse the cached built wheels to accelerate the installation. #200 Make update strategy and save strategy configurable in pdm config. #202 Improve the error message to give more insight on what to do when resolution fails. #207 Set classifiers dynamic in pyproject.toml template for autogeneration. #209","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_27","text":"Fix a bug that distributions are not removed clearly in parallel mode. #204 Fix a bug that python specifier is_subset() returns incorrect result. #206","title":"Bug Fixes"},{"location":"changelog/#release-v0123-2020-12-21","text":"","title":"Release v0.12.3 (2020-12-21)"},{"location":"changelog/#dependencies_8","text":"Pin pdm-pep517 to <0.3.0 , this is the last version to support legacy project metadata format.","title":"Dependencies"},{"location":"changelog/#release-v0122-2020-12-17","text":"","title":"Release v0.12.2 (2020-12-17)"},{"location":"changelog/#features-improvements_21","text":"Update the lock file schema, move the file hashes to [metadata.files] table. #196 Retry failed jobs when syncing packages. #197","title":"Features &amp; Improvements"},{"location":"changelog/#removals-and-deprecations_4","text":"Drop pip-shims package as a dependency. #132","title":"Removals and Deprecations"},{"location":"changelog/#miscellany_8","text":"Fix the cache path for CI. #199","title":"Miscellany"},{"location":"changelog/#release-v0121-2020-12-14","text":"","title":"Release v0.12.1 (2020-12-14)"},{"location":"changelog/#features-improvements_22","text":"Provide an option to export requirements from pyproject.toml #190 For Windows users, pdm --pep582 can enable PEP 582 globally by manipulating the WinReg. #191","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_28","text":"Inject __pypackages__ into PATH env var during pdm run . #193","title":"Bug Fixes"},{"location":"changelog/#release-v0120-2020-12-08","text":"","title":"Release v0.12.0 (2020-12-08)"},{"location":"changelog/#features-improvements_23","text":"Improve the user experience of pdm run : Add a special key in tool.pdm.scripts that holds configurations shared by all scripts. Support loading env var from a dot-env file. Add a flag -s/--site-packages to include system site-packages when running. #178 Now PEP 582 can be enabled in the Python interpreter directly! #181","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_29","text":"Ensure setuptools is installed before invoking editable install script. #174 Require wheel not wheels for global projects #182 Write a sitecustomize.py instead of a .pth file to enable PEP 582. Thanks @Aloxaf. Update get_package_finder() to be compatible with pip 20.3 . #185 Fix the help messages of commands \"cache\" and \"remove\" #187","title":"Bug Fixes"},{"location":"changelog/#release-v0110-2020-11-20","text":"","title":"Release v0.11.0 (2020-11-20)"},{"location":"changelog/#features-improvements_24","text":"Support custom script shortcuts in pyproject.toml . Support custom script shortcuts defined in [tool.pdm.scripts] section. Add pdm run --list/-l to show the list of script shortcuts. #168 Patch the halo library to support parallel spinners. Change the looking of pdm install . #169","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_30","text":"Fix a bug that package's marker fails to propagate to its grandchildren if they have already been resolved. #170 Fix a bug that bare version specifiers in Poetry project can't be converted correctly. #172 Fix the build error that destination directory is not created automatically. #173","title":"Bug Fixes"},{"location":"changelog/#release-v0102-2020-11-05","text":"","title":"Release v0.10.2 (2020-11-05)"},{"location":"changelog/#bug-fixes_31","text":"Building editable distribution does not install build-system.requires anymore. #167","title":"Bug Fixes"},{"location":"changelog/#release-v0101-2020-11-04","text":"","title":"Release v0.10.1 (2020-11-04)"},{"location":"changelog/#bug-fixes_32","text":"Switch the PEP 517 build frontend from build to a home-grown version. #162 Synchronize the output of LogWrapper . #164 Fix a bug that is_subset and is_superset may return wrong result when wildcard excludes overlaps with the upper bound. #165","title":"Bug Fixes"},{"location":"changelog/#release-v0100-2020-10-20","text":"","title":"Release v0.10.0 (2020-10-20)"},{"location":"changelog/#features-improvements_25","text":"Change to Git style config command. #157 Add a command to generate scripts for autocompletion, which is backed by pycomplete . #159","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_33","text":"Fix a bug that sitecustomize.py incorrectly gets injected into the editable console scripts. #158","title":"Bug Fixes"},{"location":"changelog/#release-v092-2020-10-13","text":"","title":"Release v0.9.2 (2020-10-13)"},{"location":"changelog/#features-improvements_26","text":"Cache the built wheels to accelerate resolution and installation process. #153","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_34","text":"Fix a bug that no wheel is matched when finding candidates to install. #155 Fix a bug that installation in parallel will cause encoding initialization error on Ubuntu. #156","title":"Bug Fixes"},{"location":"changelog/#release-v091-2020-10-13","text":"","title":"Release v0.9.1 (2020-10-13)"},{"location":"changelog/#features-improvements_27","text":"Display plain text instead of spinner bar under verbose mode. #150","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_35","text":"Fix a bug that the result of find_matched() is exhausted when accessed twice. #149","title":"Bug Fixes"},{"location":"changelog/#release-v090-2020-10-08","text":"","title":"Release v0.9.0 (2020-10-08)"},{"location":"changelog/#features-improvements_28","text":"Allow users to combine several dependency sections to form an extra require. #131 Split the PEP 517 backend to its own(battery included) package. #134 Add a new option to list command to show reverse dependency graph. #137","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_36","text":"Fix a bug that spaces in path causes requirement parsing error. #138 Fix a bug that requirement's python constraint is not respected when resolving. #141","title":"Bug Fixes"},{"location":"changelog/#dependencies_9","text":"Update pdm-pep517 to 0.2.0 that supports reading version from SCM. #146","title":"Dependencies"},{"location":"changelog/#miscellany_9","text":"Add Python 3.9 to the CI version matrix to verify. #144","title":"Miscellany"},{"location":"changelog/#release-v087-2020-09-04","text":"","title":"Release v0.8.7 (2020-09-04)"},{"location":"changelog/#bug-fixes_37","text":"Fix a compatibility issue with wheel==0.35 . #135","title":"Bug Fixes"},{"location":"changelog/#release-v086-2020-07-09","text":"","title":"Release v0.8.6 (2020-07-09)"},{"location":"changelog/#bug-fixes_38","text":"Fix a bug that extra sources are not respected when fetching distributions. #127","title":"Bug Fixes"},{"location":"changelog/#release-v085-2020-06-24","text":"","title":"Release v0.8.5 (2020-06-24)"},{"location":"changelog/#bug-fixes_39","text":"Fix a bug that pdm export fails when the project doesn't have name property. #126","title":"Bug Fixes"},{"location":"changelog/#dependencies_10","text":"Upgrade dependency pip to 20.1 . #125","title":"Dependencies"},{"location":"changelog/#release-v084-2020-05-21","text":"","title":"Release v0.8.4 (2020-05-21)"},{"location":"changelog/#features-improvements_29","text":"Add a new command export to export to alternative formats. #117","title":"Features &amp; Improvements"},{"location":"changelog/#miscellany_10","text":"Add Dockerfile and pushed to Docker Hub. #122","title":"Miscellany"},{"location":"changelog/#release-v083-2020-05-15","text":"","title":"Release v0.8.3 (2020-05-15)"},{"location":"changelog/#bug-fixes_40","text":"Fix the version constraint parsing of wheel metadata. #120","title":"Bug Fixes"},{"location":"changelog/#release-v082-2020-05-03","text":"","title":"Release v0.8.2 (2020-05-03)"},{"location":"changelog/#bug-fixes_41","text":"Update resolvers to resolvelib 0.4.0. #118","title":"Bug Fixes"},{"location":"changelog/#release-v081-2020-04-22","text":"","title":"Release v0.8.1 (2020-04-22)"},{"location":"changelog/#dependencies_11","text":"Switch to upstream resolvelib 0.3.0 . #116","title":"Dependencies"},{"location":"changelog/#release-v080-2020-04-20","text":"","title":"Release v0.8.0 (2020-04-20)"},{"location":"changelog/#features-improvements_30","text":"Add a new command to search for packages #111 Add show command to show package metadata. #114","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_42","text":"Fix a bug that environment markers cannot be evaluated correctly if extras are connected with \"or\". #107 Don't consult PyPI JSON API by default for package metadata. #112 Eliminate backslashes in markers for TOML documents. #115","title":"Bug Fixes"},{"location":"changelog/#release-v071-2020-04-13","text":"","title":"Release v0.7.1 (2020-04-13)"},{"location":"changelog/#bug-fixes_43","text":"Editable packages requires setuptools to be installed in the isolated environment.","title":"Bug Fixes"},{"location":"changelog/#release-v070-2020-04-12","text":"","title":"Release v0.7.0 (2020-04-12)"},{"location":"changelog/#features-improvements_31","text":"Disable loading of site-packages under PEP 582 mode. #100","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_44","text":"Fix a bug that TOML parsing error is not correctly captured. #101 Fix a bug of building wheels with C extensions that the platform in file name is incorrect. #99","title":"Bug Fixes"},{"location":"changelog/#release-v065-2020-04-07","text":"","title":"Release v0.6.5 (2020-04-07)"},{"location":"changelog/#bug-fixes_45","text":"Unix style executable script suffix is missing.","title":"Bug Fixes"},{"location":"changelog/#release-v064-2020-04-07","text":"","title":"Release v0.6.4 (2020-04-07)"},{"location":"changelog/#features-improvements_32","text":"Update shebang lines in the executable scripts when doing pdm use . #96 Auto-detect commonly used venv directories. #97","title":"Features &amp; Improvements"},{"location":"changelog/#release-v063-2020-03-30","text":"","title":"Release v0.6.3 (2020-03-30)"},{"location":"changelog/#bug-fixes_46","text":"Fix a bug of moving files across different file system. #95","title":"Bug Fixes"},{"location":"changelog/#release-v062-2020-03-29","text":"","title":"Release v0.6.2 (2020-03-29)"},{"location":"changelog/#bug-fixes_47","text":"Validate user input for python_requires when initializing project. #89 Ensure wheel package is available before building packages. #90 Fix an issue of remove command that will unexpectedly uninstall packages in default section. #92","title":"Bug Fixes"},{"location":"changelog/#dependencies_12","text":"Update dependencies pythonfinder , python-cfonts , pip-shims and many others. Drop dependency vistir . #89","title":"Dependencies"},{"location":"changelog/#release-v061-2020-03-25","text":"","title":"Release v0.6.1 (2020-03-25)"},{"location":"changelog/#features-improvements_33","text":"Redirect output messages to log file for installation and locking. #84","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_48","text":"Fix a bug that parallel installation fails due to setuptools reinstalling. #83","title":"Bug Fixes"},{"location":"changelog/#release-v060-2020-03-20","text":"","title":"Release v0.6.0 (2020-03-20)"},{"location":"changelog/#features-improvements_34","text":"Support specifying build script for C extensions. #23 Add test cases for pdm build . #81 Make it configurable whether to consult PyPI JSON API since it may be not trustable. Support parallel installation. Add new command pmd import to import project metadata from Pipfile , poetry , flit , requirements.txt . #79 pdm init and pdm install will auto-detect possible files that can be imported.","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_49","text":"Fix wheel builds when package_dir is mapped. #81 pdm init will use the current directory rather than finding the parents when global project is not activated.","title":"Bug Fixes"},{"location":"changelog/#release-v050-2020-03-14","text":"","title":"Release v0.5.0 (2020-03-14)"},{"location":"changelog/#features-improvements_35","text":"Introduce a super easy-to-extend plug-in system to PDM. #75","title":"Features &amp; Improvements"},{"location":"changelog/#improved-documentation_8","text":"Documentation on how to write a plugin. #75","title":"Improved Documentation"},{"location":"changelog/#bug-fixes_50","text":"Fix a typo in metadata parsing from plugins to entry_points","title":"Bug Fixes"},{"location":"changelog/#release-v042-2020-03-13","text":"","title":"Release v0.4.2 (2020-03-13)"},{"location":"changelog/#features-improvements_36","text":"Refactor the CLI part, switch from click to argparse , for better extensibility. #73 Allow users to configure to install packages into venv when it is activated. #74","title":"Features &amp; Improvements"},{"location":"changelog/#release-v041-2020-03-11","text":"","title":"Release v0.4.1 (2020-03-11)"},{"location":"changelog/#features-improvements_37","text":"Add a minimal dependency set for global project. #72","title":"Features &amp; Improvements"},{"location":"changelog/#release-v040-2020-03-10","text":"","title":"Release v0.4.0 (2020-03-10)"},{"location":"changelog/#features-improvements_38","text":"Global project support Add a new option -g/--global to manage global project. The default location is at ~/.pdm/global-project . Use the virtualenv interpreter when detected inside an activated venv. Add a new option -p/--project to select project root other than the default one. #30 Add a new command pdm config del to delete an existing config item. #71","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_51","text":"Fix a URL parsing issue that username will be dropped in the SSH URL. #68","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_9","text":"Add docs for global project and selecting project path. #30","title":"Improved Documentation"},{"location":"changelog/#release-v032-2020-03-08","text":"","title":"Release v0.3.2 (2020-03-08)"},{"location":"changelog/#features-improvements_39","text":"Display all available Python interpreters if users don't give one in pdm init . #67","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_52","text":"Regard 4.0 as infinite upper bound when checking subsetting. #66","title":"Bug Fixes"},{"location":"changelog/#release-v031-2020-03-07","text":"","title":"Release v0.3.1 (2020-03-07)"},{"location":"changelog/#bug-fixes_53","text":"Fix a bug that ImpossiblePySpec 's hash clashes with normal one.","title":"Bug Fixes"},{"location":"changelog/#release-v030-2020-02-28","text":"","title":"Release v0.3.0 (2020-02-28)"},{"location":"changelog/#features-improvements_40","text":"Add a new command pdm config to inspect configurations. #26 Add a new command pdm cache clear to clean caches. #63","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_54","text":"Correctly show dependency graph when circular dependencies exist. #62","title":"Bug Fixes"},{"location":"changelog/#improved-documentation_10","text":"Write the initial documentation for PDM. #14","title":"Improved Documentation"},{"location":"changelog/#release-v026-2020-02-25","text":"","title":"Release v0.2.6 (2020-02-25)"},{"location":"changelog/#features-improvements_41","text":"Improve the user interface of selecting Python interpreter. #54","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_55","text":"Fix the wheel installer to correctly unparse the flags of console scripts. #56 Fix a bug that OS-dependent hashes are not saved. #57","title":"Bug Fixes"},{"location":"changelog/#release-v025-2020-02-22","text":"","title":"Release v0.2.5 (2020-02-22)"},{"location":"changelog/#features-improvements_42","text":"Allow specifying Python interpreter via --python option in pdm init . #49 Set python_requires when initializing and defaults to >={current_version} . #50","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_56","text":"Always consider wheels before tarballs; correctly merge markers from different parents. #47 Filter out incompatible wheels when installing. #48","title":"Bug Fixes"},{"location":"changelog/#release-v024-2020-02-21","text":"","title":"Release v0.2.4 (2020-02-21)"},{"location":"changelog/#bug-fixes_57","text":"Use the project local interpreter to build wheels. #43 Correctly merge Python specifiers when possible. #4","title":"Bug Fixes"},{"location":"changelog/#release-v023-2020-02-21","text":"","title":"Release v0.2.3 (2020-02-21)"},{"location":"changelog/#bug-fixes_58","text":"Fix a bug that editable build generates a malformed setup.py .","title":"Bug Fixes"},{"location":"changelog/#release-v022-2020-02-20","text":"","title":"Release v0.2.2 (2020-02-20)"},{"location":"changelog/#features-improvements_43","text":"Add a fancy greeting banner when user types pdm --help . #42","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_59","text":"Fix the RECORD file in built wheel. #41","title":"Bug Fixes"},{"location":"changelog/#dependencies_13","text":"Add dependency python-cfonts to display banner. #42","title":"Dependencies"},{"location":"changelog/#release-v021-2020-02-18","text":"","title":"Release v0.2.1 (2020-02-18)"},{"location":"changelog/#bug-fixes_60","text":"Fix a bug that short python_version markers can't be parsed correctly. #38 Make _editable_intall.py compatible with Py2.","title":"Bug Fixes"},{"location":"changelog/#release-v020-2020-02-14","text":"","title":"Release v0.2.0 (2020-02-14)"},{"location":"changelog/#features-improvements_44","text":"New option: pdm list --graph to show a dependency graph of the working set. #10 New option: pdm update --unconstrained to ignore the version constraint of given packages. #13 Improve the error message when project is not initialized before running commands. #19 Pinned candidates in lock file are reused when relocking during pdm install . #33 Use the pyenv interpreter value if pyenv is installed. #36 Introduce a new command pdm info to show project environment information. #9","title":"Features &amp; Improvements"},{"location":"changelog/#bug-fixes_61","text":"Fix a bug that candidate hashes will be lost when reused. #11","title":"Bug Fixes"},{"location":"changelog/#dependencies_14","text":"Update pip to 20.0 , update pip_shims to 0.5.0 . #28","title":"Dependencies"},{"location":"changelog/#miscellany_11","text":"Add a script named setup_dev.py for the convenience to setup pdm for development. #29","title":"Miscellany"},{"location":"changelog/#release-v012-2020-02-09","text":"","title":"Release v0.1.2 (2020-02-09)"},{"location":"changelog/#features","text":"New command pdm use to switch python versions. #8 New option pdm list --graph to show a dependency graph. #10 Read metadata from lockfile when pinned candidate is reused.","title":"Features"},{"location":"changelog/#release-v011-2020-02-07","text":"","title":"Release v0.1.1 (2020-02-07)"},{"location":"changelog/#features_1","text":"Get version from the specified file. #6 Add column header to pdm list output.","title":"Features"},{"location":"changelog/#release-v010-2020-02-07","text":"","title":"Release v0.1.0 (2020-02-07)"},{"location":"changelog/#bugfixes","text":"Pass exit code to parent process in pdm run. Fix error handling for CLI. #19","title":"Bugfixes"},{"location":"changelog/#miscellany_12","text":"Refactor the installer mocking for tests.","title":"Miscellany"},{"location":"changelog/#release-v005-2020-01-22","text":"","title":"Release v0.0.5 (2020-01-22)"},{"location":"changelog/#improvements","text":"Ensure pypi index url is fetched in addition to the source settings. #3","title":"Improvements"},{"location":"changelog/#bugfixes_1","text":"Fix an issue that leading \"c\"s are mistakenly stripped. #5 Fix an error with PEP 517 building.","title":"Bugfixes"},{"location":"changelog/#release-v004-2020-01-22","text":"","title":"Release v0.0.4 (2020-01-22)"},{"location":"changelog/#improvements_1","text":"Fix editable installation, now editable scripts can also be executed from outside! Content hash is calculated based on dependencies and sources, not other metadata.","title":"Improvements"},{"location":"changelog/#bugfixes_2","text":"Fix an issue that editable distributions can not be removed.","title":"Bugfixes"},{"location":"changelog/#release-v003-2020-01-22","text":"","title":"Release v0.0.3 (2020-01-22)"},{"location":"changelog/#features_2","text":"Add pdm init to bootstrap a project.","title":"Features"},{"location":"changelog/#release-v002-2020-01-22","text":"","title":"Release v0.0.2 (2020-01-22)"},{"location":"changelog/#features_3","text":"A complete functioning PEP 517 build backend. pdm builld command.","title":"Features"},{"location":"changelog/#miscellany_13","text":"Add a Chinese README","title":"Miscellany"},{"location":"changelog/#features_4","text":"Add pdm init to bootstrap a project.","title":"Features"},{"location":"changelog/#release-v001-2020-01-20","text":"","title":"Release v0.0.1 (2020-01-20)"},{"location":"changelog/#features_5","text":"A dependency resolver that just works. A PEP 582 installer. PEP 440 version specifiers. PEP 508 environment markers. Running scripts with PEP 582 local packages. Console scripts are injected with local paths. A neat CLI. add, lock, list, update, remove commands. PEP 517 build backends. Continuous Integration.","title":"Features"},{"location":"configuration/","text":"Available Configurations # Config Item Description Default Value Available in Project Env var cache_dir The root directory of cached files The default cache location on OS No auto_global Use global package implicitly if no local project is found False No PDM_AUTO_GLOBAL use_venv Install packages into the activated venv site packages instead of PEP 582 False Yes PDM_USE_VENV parallel_install Whether to perform installation and uninstallation in parallel True Yes PDM_PARALLEL_INSTALL python.path The Python interpreter path Yes PDM_PYTHON python.use_pyenv Use the pyenv interpreter True Yes pypi.url The URL of PyPI mirror Read index-url in pip.conf , or https://pypi.org/simple if not found Yes PDM_PYPI_URL pypi.verify_ssl Verify SSL certificate when query PyPI Read trusted-hosts in pip.conf , defaults to True Yes pypi.json_api Consult PyPI's JSON API for package metadata False Yes PDM_PYPI_JSON_API strategy.save Specify how to save versions when a package is added compatible (can be: exact , wildcard ) Yes strategy.update The default strategy for updating packages reuse (can be : eager ) Yes strategy.resolve_max_rounds Specify the max rounds of resolution process 1000 Yes PDM_RESOLVE_MAX_ROUNDS If the corresponding env var is set, the value will take precedence over what is saved in the config file.","title":"Configuration"},{"location":"configuration/#available-configurations","text":"Config Item Description Default Value Available in Project Env var cache_dir The root directory of cached files The default cache location on OS No auto_global Use global package implicitly if no local project is found False No PDM_AUTO_GLOBAL use_venv Install packages into the activated venv site packages instead of PEP 582 False Yes PDM_USE_VENV parallel_install Whether to perform installation and uninstallation in parallel True Yes PDM_PARALLEL_INSTALL python.path The Python interpreter path Yes PDM_PYTHON python.use_pyenv Use the pyenv interpreter True Yes pypi.url The URL of PyPI mirror Read index-url in pip.conf , or https://pypi.org/simple if not found Yes PDM_PYPI_URL pypi.verify_ssl Verify SSL certificate when query PyPI Read trusted-hosts in pip.conf , defaults to True Yes pypi.json_api Consult PyPI's JSON API for package metadata False Yes PDM_PYPI_JSON_API strategy.save Specify how to save versions when a package is added compatible (can be: exact , wildcard ) Yes strategy.update The default strategy for updating packages reuse (can be : eager ) Yes strategy.resolve_max_rounds Specify the max rounds of resolution process 1000 Yes PDM_RESOLVE_MAX_ROUNDS If the corresponding env var is set, the value will take precedence over what is saved in the config file.","title":"Available Configurations"},{"location":"contributing/","text":"Contributing to PDM # First off, thanks for taking the time to contribute! Contributions include but are not restricted to: Reporting bugs Contributing to code Writing tests Writing documentation The following is a set of guidelines for contributing. A recommended flow of contributing to an Open Source project # This section is for beginners to OSS. If you are an experienced OSS developer, you can skip this section. First, fork this project to your own namespace using the fork button at the top right of the repository page. Clone the upstream repository to local: 1 2 3 $ git clone https://github.com/pdm-project/pdm.git # Or if you prefer SSH clone: $ git clone git@github.com:pdm-project/pdm.git Add the fork as a new remote: 1 2 $ git remote add fork https://github.com/yourname/pdm.git $ git fetch fork where fork is the remote name of the fork repository. ProTips: Don't modify code on the main branch, the main branch should always keep track of origin/main. To update main branch to date: 1 2 3 $ git pull origin main # In rare cases that your local main branch diverges from the remote main: $ git fetch origin && git reset --hard main Create a new branch based on the up-to-date main branch for new patches. Create a Pull Request from that patch branch. Local development # To make sure the tests suites can run correctly, you need to install Git LFS , then 1 2 3 $ git lfs install # If you have already cloned the repository, execute the below command as well. $ git lfs pull Then, you need to install base dependencies in a venv. Although PDM uses a local package directory to install dependencies, venv is still needed to start up PDM for the first time: 1 $ python setup_dev.py Now, all dependencies are installed into the local __pypackages__ directory, which will be used for development after this point. The pdm executable located at __pypackages__/<VERSION>/bin can be run directly from outside, which is installed in editable mode, or you can use python -m pdm from inside the venv. Run tests # 1 $ pdm run test The test suite is still simple and needs expansion! Please help write more test cases. Code style # PDM uses pre-commit for linting. Install pre-commit first, then: 1 2 $ pre-commit install $ pdm run lint PDM uses black for code style and isort for sorting import statements. If you are not following them, the CI will fail and your Pull Request will not be merged. News fragments # When you make changes such as fixing a bug or adding a feature, you must add a news fragment describing your change. News fragments are placed in the news/ directory, and should be named according to this pattern: <issue_num>.<issue_type>.md (e.g., 566.bugfix.md ). Issue Types # feature : Features and improvements bugfix : Bug fixes refactor : Code restructures doc : Added or improved documentation dep : Changes to dependencies removal : Removals or deprecations in the API misc : Miscellaneous changes that don't fit any of the other categories The contents of the file should be a single sentence in the imperative mood that describes your changes. (e.g., Deduplicate the plugins list. ) See entries in the Change Log for more examples. Preview the documentation # If you make some changes to the docs/ and you want to preview the build result, simply do: 1 $ pdm run doc","title":"Contributing"},{"location":"contributing/#contributing-to-pdm","text":"First off, thanks for taking the time to contribute! Contributions include but are not restricted to: Reporting bugs Contributing to code Writing tests Writing documentation The following is a set of guidelines for contributing.","title":"Contributing to PDM"},{"location":"contributing/#a-recommended-flow-of-contributing-to-an-open-source-project","text":"This section is for beginners to OSS. If you are an experienced OSS developer, you can skip this section. First, fork this project to your own namespace using the fork button at the top right of the repository page. Clone the upstream repository to local: 1 2 3 $ git clone https://github.com/pdm-project/pdm.git # Or if you prefer SSH clone: $ git clone git@github.com:pdm-project/pdm.git Add the fork as a new remote: 1 2 $ git remote add fork https://github.com/yourname/pdm.git $ git fetch fork where fork is the remote name of the fork repository. ProTips: Don't modify code on the main branch, the main branch should always keep track of origin/main. To update main branch to date: 1 2 3 $ git pull origin main # In rare cases that your local main branch diverges from the remote main: $ git fetch origin && git reset --hard main Create a new branch based on the up-to-date main branch for new patches. Create a Pull Request from that patch branch.","title":"A recommended flow of contributing to an Open Source project"},{"location":"contributing/#local-development","text":"To make sure the tests suites can run correctly, you need to install Git LFS , then 1 2 3 $ git lfs install # If you have already cloned the repository, execute the below command as well. $ git lfs pull Then, you need to install base dependencies in a venv. Although PDM uses a local package directory to install dependencies, venv is still needed to start up PDM for the first time: 1 $ python setup_dev.py Now, all dependencies are installed into the local __pypackages__ directory, which will be used for development after this point. The pdm executable located at __pypackages__/<VERSION>/bin can be run directly from outside, which is installed in editable mode, or you can use python -m pdm from inside the venv.","title":"Local development"},{"location":"contributing/#run-tests","text":"1 $ pdm run test The test suite is still simple and needs expansion! Please help write more test cases.","title":"Run tests"},{"location":"contributing/#code-style","text":"PDM uses pre-commit for linting. Install pre-commit first, then: 1 2 $ pre-commit install $ pdm run lint PDM uses black for code style and isort for sorting import statements. If you are not following them, the CI will fail and your Pull Request will not be merged.","title":"Code style"},{"location":"contributing/#news-fragments","text":"When you make changes such as fixing a bug or adding a feature, you must add a news fragment describing your change. News fragments are placed in the news/ directory, and should be named according to this pattern: <issue_num>.<issue_type>.md (e.g., 566.bugfix.md ).","title":"News fragments"},{"location":"contributing/#issue-types","text":"feature : Features and improvements bugfix : Bug fixes refactor : Code restructures doc : Added or improved documentation dep : Changes to dependencies removal : Removals or deprecations in the API misc : Miscellaneous changes that don't fit any of the other categories The contents of the file should be a single sentence in the imperative mood that describes your changes. (e.g., Deduplicate the plugins list. ) See entries in the Change Log for more examples.","title":"Issue Types"},{"location":"contributing/#preview-the-documentation","text":"If you make some changes to the docs/ and you want to preview the build result, simply do: 1 $ pdm run doc","title":"Preview the documentation"},{"location":"plugin/","text":"Write a plugin # PDM is aiming at being a community driven package manager. It is shipped with a full-featured plug-in system, with which you can: Develop a new command for PDM Add additional options to existing PDM commands Change PDM's behavior by reading additional config items Control the process of dependency resolution or installation What should a plugin do # The core PDM project focuses on dependency management and package publishing. Other functionalities you wish to integrate with PDM are preferred to lie in their own plugins and released as standalone PyPI projects. In case the plugin is considered a good supplement of the core project it may have a chance to be absorbed into PDM. Write your own plugin # In the following sections, I will show an example of adding a new command hello which reads the hello.name config. Write the command # The PDM's CLI module is designed in a way that user can easily \"inherit and modify\". To write a new command: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from pdm.cli.commands.base import BaseCommand class HelloCommand ( BaseCommand ): \"\"\"Say hello to the specified person. If none is given, will read from \"hello.name\" config. \"\"\" def add_arguments ( self , parser ): parser . add_argument ( \"-n\" , \"--name\" , help = \"the person's name to whom you greet\" ) def handle ( self , project , options ): if not options . name : name = project . config [ \"hello.name\" ] else : name = options . name print ( f \"Hello, { name } \" ) First, let's create a new HelloCommand class inherting from pdm.cli.commands.base.BaseCommand . It has two major functions: add_arguments() to manipulate the argument parser passed as the only argument, where you can add additional command line arguments to it handle() to do something when the subcommand is matched, you can do nothing by writing a single pass statement. It accepts two arguments: an pdm.project.Project object as the first one and the parsed argparse.Namespace object as the second. The document string will serve as the command help text, which will be shown in pdm --help . Besides, PDM's subcommand has two default options: -v/--verbose to change the verbosity level and -g/--global to enable global project. If you don't want these default options, override the arguments class attribute to a list of pdm.cli.options.Option objects, or assign it to an empty list to have no default options: 1 2 3 class HelloCommand ( BaseCommand ): arguments = [] Note The default options are loaded first, then add_arguments() is called. Register the command to the core object # Write a function somewhere in your plugin project. There is no limit on what the name of the function is, but the function should take only one argument -- the PDM core object: 1 2 def hello_plugin ( core ): core . register_command ( HelloCommand , \"hello\" ) Call core.register_command() to register the command. The second argument as the name of the subcommand is optional. PDM will look for the HelloCommand 's name attribute if the name is not passed. Add a new config item # Let's recall the first code snippet, hello.name config key is consulted for the name if not passed via the command line. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 class HelloCommand ( BaseCommand ): \"\"\"Say hello to the specified person. If none is given, will read from \"hello.name\" config. \"\"\" def add_arguments ( self , parser ): parser . add_argument ( \"-n\" , \"--name\" , help = \"the person's name to whom you greet\" ) def handle ( self , project , options ): if not options . name : name = project . config [ \"hello.name\" ] else : name = options . name print ( f \"Hello, { name } \" ) Till now, if you query the config value by pdm config get hello.name , an error will pop up saying it is not a valid config key. You need to register the config item, too: 1 2 3 4 5 from pdm.project.config import ConfigItem def hello_plugin ( core ): core . register_command ( HelloCommand , \"hello\" ) core . add_config ( \"hello.name\" , ConfigItem ( \"The person's name\" , \"John\" )) where ConfigItem class takes 4 parameters, in the following order: description : a description of the config item default : default value of the config item global_only : whether the config is allowed to set in home config only env_var : the name of environment variable which will be read as the config value Other plugin points # Besides of commands and configurations, PDM provides some other plugin abilities which are not covered in the above example: core.project_class : change the class of project object core.repository_class : change the class of repository object, which controls how to look for candidates and metadata of a package core.resolver_class : change the resolver class, to control the resolution process core.synchronizer_class : change the synchronizer_class, to control the installation process core.parser : add arguments to the root argument parser Tips about developing a PDM plugin. # When developing a plugin, one hopes to activate and plugin in development and get updated when the code changes. This is usually done by pip install -e . or python setup.py develop in the traditional Python packaging world which leverages setup.py to do so. However, as there is no such setup.py in a PDM project, how can we do that? Fortunately, it becomes even easier with PDM and PEP 582. First, you should enable PEP 582 globally following the corresponding part of this doc . Then you just need to install all dependencies into the __pypackages__ directory by: 1 $ pdm install After that, all the dependencies are available with a compatible Python interpreter, including the plugin itself, in editable mode. That means any change to the codebase will take effect immediately without re-installation. The pdm executable also uses a Python interpreter under the hood, so if you run pdm from inside the plugin project, the plugin in development will be activated automatically, and you can do some testing to see how it works. That is how PEP 582 benefits our development workflow. Publish your plugin # Now you have defined your plugin already, let's distribute it to PyPI. PDM's plugins are discovered by entry point types. Create an pdm entry point and point to your plugin callable (yeah, it doesn't need to be a function, any callable object can work): PEP 621 : 1 2 3 4 # pyproject.toml [project.entry-points.pdm] hello = \"my_plugin:hello_plugin\" setuptools : 1 2 3 4 5 6 7 # setup.py setup ( ... entry_points = { \"pdm\" : [ \"hello = my_plugin:hello_plugin\" ]} ... ) Activate the plugin # As plugins are loaded via entry points, they can be activated with no more steps than just installing the plugin. Assume your plugin is published as pdm-hello , and if you installed pdm via pipx : 1 $ pipx inject pdm pdm-hello Or if you installed pdm via homebrew : 1 $ $( brew --prefix pdm ) /libexec/bin/python -m pip install pdm-hello Otherwise, if you installed pdm with normal pip install : 1 $ pip install --user pdm-hello The main principle is you must install the plugin in the same site-package directory as pdm . Now type in pdm --help in the terminal, you will see the new added hello command and use it: 1 2 $ pdm hello Jack Hello, Jack","title":"Write a plugin"},{"location":"plugin/#write-a-plugin","text":"PDM is aiming at being a community driven package manager. It is shipped with a full-featured plug-in system, with which you can: Develop a new command for PDM Add additional options to existing PDM commands Change PDM's behavior by reading additional config items Control the process of dependency resolution or installation","title":"Write a plugin"},{"location":"plugin/#what-should-a-plugin-do","text":"The core PDM project focuses on dependency management and package publishing. Other functionalities you wish to integrate with PDM are preferred to lie in their own plugins and released as standalone PyPI projects. In case the plugin is considered a good supplement of the core project it may have a chance to be absorbed into PDM.","title":"What should a plugin do"},{"location":"plugin/#write-your-own-plugin","text":"In the following sections, I will show an example of adding a new command hello which reads the hello.name config.","title":"Write your own plugin"},{"location":"plugin/#write-the-command","text":"The PDM's CLI module is designed in a way that user can easily \"inherit and modify\". To write a new command: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from pdm.cli.commands.base import BaseCommand class HelloCommand ( BaseCommand ): \"\"\"Say hello to the specified person. If none is given, will read from \"hello.name\" config. \"\"\" def add_arguments ( self , parser ): parser . add_argument ( \"-n\" , \"--name\" , help = \"the person's name to whom you greet\" ) def handle ( self , project , options ): if not options . name : name = project . config [ \"hello.name\" ] else : name = options . name print ( f \"Hello, { name } \" ) First, let's create a new HelloCommand class inherting from pdm.cli.commands.base.BaseCommand . It has two major functions: add_arguments() to manipulate the argument parser passed as the only argument, where you can add additional command line arguments to it handle() to do something when the subcommand is matched, you can do nothing by writing a single pass statement. It accepts two arguments: an pdm.project.Project object as the first one and the parsed argparse.Namespace object as the second. The document string will serve as the command help text, which will be shown in pdm --help . Besides, PDM's subcommand has two default options: -v/--verbose to change the verbosity level and -g/--global to enable global project. If you don't want these default options, override the arguments class attribute to a list of pdm.cli.options.Option objects, or assign it to an empty list to have no default options: 1 2 3 class HelloCommand ( BaseCommand ): arguments = [] Note The default options are loaded first, then add_arguments() is called.","title":"Write the command"},{"location":"plugin/#register-the-command-to-the-core-object","text":"Write a function somewhere in your plugin project. There is no limit on what the name of the function is, but the function should take only one argument -- the PDM core object: 1 2 def hello_plugin ( core ): core . register_command ( HelloCommand , \"hello\" ) Call core.register_command() to register the command. The second argument as the name of the subcommand is optional. PDM will look for the HelloCommand 's name attribute if the name is not passed.","title":"Register the command to the core object"},{"location":"plugin/#add-a-new-config-item","text":"Let's recall the first code snippet, hello.name config key is consulted for the name if not passed via the command line. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 class HelloCommand ( BaseCommand ): \"\"\"Say hello to the specified person. If none is given, will read from \"hello.name\" config. \"\"\" def add_arguments ( self , parser ): parser . add_argument ( \"-n\" , \"--name\" , help = \"the person's name to whom you greet\" ) def handle ( self , project , options ): if not options . name : name = project . config [ \"hello.name\" ] else : name = options . name print ( f \"Hello, { name } \" ) Till now, if you query the config value by pdm config get hello.name , an error will pop up saying it is not a valid config key. You need to register the config item, too: 1 2 3 4 5 from pdm.project.config import ConfigItem def hello_plugin ( core ): core . register_command ( HelloCommand , \"hello\" ) core . add_config ( \"hello.name\" , ConfigItem ( \"The person's name\" , \"John\" )) where ConfigItem class takes 4 parameters, in the following order: description : a description of the config item default : default value of the config item global_only : whether the config is allowed to set in home config only env_var : the name of environment variable which will be read as the config value","title":"Add a new config item"},{"location":"plugin/#other-plugin-points","text":"Besides of commands and configurations, PDM provides some other plugin abilities which are not covered in the above example: core.project_class : change the class of project object core.repository_class : change the class of repository object, which controls how to look for candidates and metadata of a package core.resolver_class : change the resolver class, to control the resolution process core.synchronizer_class : change the synchronizer_class, to control the installation process core.parser : add arguments to the root argument parser","title":"Other plugin points"},{"location":"plugin/#tips-about-developing-a-pdm-plugin","text":"When developing a plugin, one hopes to activate and plugin in development and get updated when the code changes. This is usually done by pip install -e . or python setup.py develop in the traditional Python packaging world which leverages setup.py to do so. However, as there is no such setup.py in a PDM project, how can we do that? Fortunately, it becomes even easier with PDM and PEP 582. First, you should enable PEP 582 globally following the corresponding part of this doc . Then you just need to install all dependencies into the __pypackages__ directory by: 1 $ pdm install After that, all the dependencies are available with a compatible Python interpreter, including the plugin itself, in editable mode. That means any change to the codebase will take effect immediately without re-installation. The pdm executable also uses a Python interpreter under the hood, so if you run pdm from inside the plugin project, the plugin in development will be activated automatically, and you can do some testing to see how it works. That is how PEP 582 benefits our development workflow.","title":"Tips about developing a PDM plugin."},{"location":"plugin/#publish-your-plugin","text":"Now you have defined your plugin already, let's distribute it to PyPI. PDM's plugins are discovered by entry point types. Create an pdm entry point and point to your plugin callable (yeah, it doesn't need to be a function, any callable object can work): PEP 621 : 1 2 3 4 # pyproject.toml [project.entry-points.pdm] hello = \"my_plugin:hello_plugin\" setuptools : 1 2 3 4 5 6 7 # setup.py setup ( ... entry_points = { \"pdm\" : [ \"hello = my_plugin:hello_plugin\" ]} ... )","title":"Publish your plugin"},{"location":"plugin/#activate-the-plugin","text":"As plugins are loaded via entry points, they can be activated with no more steps than just installing the plugin. Assume your plugin is published as pdm-hello , and if you installed pdm via pipx : 1 $ pipx inject pdm pdm-hello Or if you installed pdm via homebrew : 1 $ $( brew --prefix pdm ) /libexec/bin/python -m pip install pdm-hello Otherwise, if you installed pdm with normal pip install : 1 $ pip install --user pdm-hello The main principle is you must install the plugin in the same site-package directory as pdm . Now type in pdm --help in the terminal, you will see the new added hello command and use it: 1 2 $ pdm hello Jack Hello, Jack","title":"Activate the plugin"},{"location":"pyproject/pep621/","text":"PEP 621 Project metadata # PDM reads the project's metadata following the standardized format of PEP 621 . View the PEP for the detailed specification. These metadata are stored in [project] table of pyproject.toml . In the following part of this document, metadata should be written under [project] table if not given explicitly. Determine the package version dynamically # You can specify a file source for version field like: version = {from = \"pdm/__init__.py\"} , in this form, the version will be read from the __version__ variable in that file. PDM can also read version from SCM tags. If you are using git or hg as the version control system, define the version as follows: 1 version = { use_scm = true } In either case, you MUST also include version in dynamic field, or the backend will raise an error: 1 dynamic = [\"version\"] Dependency specification # The project.dependencies is an array of dependency specification strings following the PEP 440 and PEP 508 . Examples: 1 2 3 4 5 6 7 8 9 10 dependencies = [ # Named requirement \"requests\" , # Named requirement with version specifier \"flask >= 1.1.0\" , # Requirement with environment marker \"pywin32; sys_platform == 'win32'\" , # URL requirement \"pip @ https://github.com/pypa/pip.git@20.3.1\" ] Editable requirement # Beside of the normal dependency specifications, one can also have some packages installed in editable mode. The editable specification string format is the same as Pip's editable install mode . Examples: 1 2 3 4 5 dependencies = [ ..., \"-e path/to/SomeProject\", \"-e git+http://repo/my_project.git#egg=SomeProject\" ] About editable installation One can have editable installation and normal installation for the same package. The one that comes at last wins. However, editable dependencies WON'T be included in the metadata of the built artifacts since they are not valid PEP 508 strings. They only exist for development purpose. Optional dependencies # You can have some requirements optional, which is similar to setuptools ' extras_require parameter. 1 2 3 4 5 6 7 [project.optional-dependencies] socks = [ 'PySocks >= 1.5.6, != 1.5.7, < 2' ] tests = [ 'ddt >= 1.2.2, < 2' , 'pytest < 6' , 'mock >= 1.0.1, < 4; python_version < \"3.4\"' , ] To install a group of optional dependencies: 1 $ pdm install -s socks -s option can be given multiple times to include more than one group. Console scripts # The following content: 1 2 [project.scripts] mycli = \"mycli.__main__:main\" will be translated to setuptools style: 1 2 3 4 5 entry_points = { 'console_scripts' : [ 'mycli=mycli.__main__:main' ] } Also, [project.gui-scripts] will be translated to gui_scripts entry points group in setuptools style. Entry points # Other types of entry points are given by [project.entry-points.<type>] section, with the same format of [project.scripts] : 1 2 [project.entry-points.pytest11] myplugin = \"mypackage.plugin:pytest_plugin\"","title":"PEP 621 Project metadata"},{"location":"pyproject/pep621/#pep-621-project-metadata","text":"PDM reads the project's metadata following the standardized format of PEP 621 . View the PEP for the detailed specification. These metadata are stored in [project] table of pyproject.toml . In the following part of this document, metadata should be written under [project] table if not given explicitly.","title":"PEP 621 Project metadata"},{"location":"pyproject/pep621/#determine-the-package-version-dynamically","text":"You can specify a file source for version field like: version = {from = \"pdm/__init__.py\"} , in this form, the version will be read from the __version__ variable in that file. PDM can also read version from SCM tags. If you are using git or hg as the version control system, define the version as follows: 1 version = { use_scm = true } In either case, you MUST also include version in dynamic field, or the backend will raise an error: 1 dynamic = [\"version\"]","title":"Determine the package version dynamically"},{"location":"pyproject/pep621/#dependency-specification","text":"The project.dependencies is an array of dependency specification strings following the PEP 440 and PEP 508 . Examples: 1 2 3 4 5 6 7 8 9 10 dependencies = [ # Named requirement \"requests\" , # Named requirement with version specifier \"flask >= 1.1.0\" , # Requirement with environment marker \"pywin32; sys_platform == 'win32'\" , # URL requirement \"pip @ https://github.com/pypa/pip.git@20.3.1\" ]","title":"Dependency specification"},{"location":"pyproject/pep621/#editable-requirement","text":"Beside of the normal dependency specifications, one can also have some packages installed in editable mode. The editable specification string format is the same as Pip's editable install mode . Examples: 1 2 3 4 5 dependencies = [ ..., \"-e path/to/SomeProject\", \"-e git+http://repo/my_project.git#egg=SomeProject\" ] About editable installation One can have editable installation and normal installation for the same package. The one that comes at last wins. However, editable dependencies WON'T be included in the metadata of the built artifacts since they are not valid PEP 508 strings. They only exist for development purpose.","title":"Editable requirement"},{"location":"pyproject/pep621/#optional-dependencies","text":"You can have some requirements optional, which is similar to setuptools ' extras_require parameter. 1 2 3 4 5 6 7 [project.optional-dependencies] socks = [ 'PySocks >= 1.5.6, != 1.5.7, < 2' ] tests = [ 'ddt >= 1.2.2, < 2' , 'pytest < 6' , 'mock >= 1.0.1, < 4; python_version < \"3.4\"' , ] To install a group of optional dependencies: 1 $ pdm install -s socks -s option can be given multiple times to include more than one group.","title":"Optional dependencies"},{"location":"pyproject/pep621/#console-scripts","text":"The following content: 1 2 [project.scripts] mycli = \"mycli.__main__:main\" will be translated to setuptools style: 1 2 3 4 5 entry_points = { 'console_scripts' : [ 'mycli=mycli.__main__:main' ] } Also, [project.gui-scripts] will be translated to gui_scripts entry points group in setuptools style.","title":"Console scripts"},{"location":"pyproject/pep621/#entry-points","text":"Other types of entry points are given by [project.entry-points.<type>] section, with the same format of [project.scripts] : 1 2 [project.entry-points.pytest11] myplugin = \"mypackage.plugin:pytest_plugin\"","title":"Entry points"},{"location":"pyproject/tool-pdm/","text":"PDM tool settings # There are also some useful settings to control the packaging behavior of PDM. They should be shipped with pyproject.toml , defined in [tool.pdm] table. Development dependencies # You can have several groups of development only dependencies. Unlike optional-dependencies , they won't appear in the package distribution metadata such as PKG-INFO or METADATA . And the package index won't be aware of these dependencies. The schema is similar to that of optional-dependencies , except that it is in tool.pdm table. 1 2 3 4 5 6 7 [tool.pdm.dev-dependencies] lint = [ \"flake8\" , \"black\" ] test = [\"pytest\", \"pytest-cov\"] doc = [\"mkdocs\"] To install all of them: 1 $ pdm install For more CLI usage, please refer to Manage Dependencies Specify other sources for finding packages # Like Pipenv, you can specify extra sources for finding packages with the same format. They are stored in an array of table named [[tool.pdm.source]] in pyproject.toml : 1 2 3 4 [[tool.pdm.source]] url = \"https://private-site.org/pypi/simple\" verify_ssl = true name = \"internal\" This works as if --extra-index-url https://private-site.org/pypi/simple is passed. Or you can override the pypi.url value by using a source named pypi : 1 2 3 4 [[tool.pdm.source]] url = \"https://private.pypi.org/simple\" verify_ssl = true name = \"pypi\" Difference from changing config value When you want all packages to be fetched from the given index instead of the default one, despite what platform your are on or who is to deploy the app, write it in the [[tool.pdm.source]] . Otherwise if you would like to change the index temporarily on the current platform (for network reasons), you should use pdm config pypi.url https://private.pypi.org/simple . Include and exclude package files # The way of specifying include and exclude files are simple, they are given as a list of glob patterns: 1 2 3 4 5 6 7 includes = [ \"**/*.json\" , \"mypackage/\" , ] excludes = [ \"mypackage/_temp/*\" ] In case you want some files to be included in sdist only, you use the source-includes field: 1 2 3 includes = [...] excludes = [...] source-includes = [\"tests/\"] Note that the files defined in source-includes will be excluded automatically from non-sdist builds. Default values for includes and excludes # If you don't specify any of these fields, PDM also provides smart default values to fit the most common workflows. Top-level packages will be included. tests package will be excluded from non-sdist builds. src directory will be detected as the package-dir if it exists. If your project follows the above conventions you don't need to config any of these fields and it just works. Be awared PDM won't add PEP 420 implicit namespace packages automatically and they should always be specified in includes explicitly. Select another package directory to look for packages # Similar to setuptools ' package_dir setting, one can specify another package directory, such as src , in pyproject.toml easily: 1 package-dir = \"src\" If no package directory is given, PDM can also recognize src as the package-dir implicitly if: src/__init__.py doesn't exist, meaning it is not a valid Python package, and There exist some packages under src/* . Implicit namespace packages # As specified in PEP 420 , a directory will be recognized as a namespace package if: <package>/__init__.py doesn't exist, and There exist normal packages and/or other namespace packages under <package>/* , and <package> is explicitly listed in includes Build C extensions # Currently, building C extensions still relies on setuptools . You should write a python script which contains a function named build and accepts the parameter dictionary of setup() as the only argument. Update the dictionary with your ext_modules settings in the function. Here is an example taken from MarkupSafe : 1 2 3 4 5 6 7 # build.py from setuptools import Extension ext_modules = [ Extension ( \"markupsafe._speedups\" , [ \"src/markupsafe/_speedups.c\" ])] def build ( setup_kwargs ): setup_kwargs . update ( ext_modules = ext_modules ) Now, specify the build script path via build in the pyproject.toml : 1 2 3 # pyproject.toml [tool.pdm] build = \"build.py\"","title":"PDM tool settings"},{"location":"pyproject/tool-pdm/#pdm-tool-settings","text":"There are also some useful settings to control the packaging behavior of PDM. They should be shipped with pyproject.toml , defined in [tool.pdm] table.","title":"PDM tool settings"},{"location":"pyproject/tool-pdm/#development-dependencies","text":"You can have several groups of development only dependencies. Unlike optional-dependencies , they won't appear in the package distribution metadata such as PKG-INFO or METADATA . And the package index won't be aware of these dependencies. The schema is similar to that of optional-dependencies , except that it is in tool.pdm table. 1 2 3 4 5 6 7 [tool.pdm.dev-dependencies] lint = [ \"flake8\" , \"black\" ] test = [\"pytest\", \"pytest-cov\"] doc = [\"mkdocs\"] To install all of them: 1 $ pdm install For more CLI usage, please refer to Manage Dependencies","title":"Development dependencies"},{"location":"pyproject/tool-pdm/#specify-other-sources-for-finding-packages","text":"Like Pipenv, you can specify extra sources for finding packages with the same format. They are stored in an array of table named [[tool.pdm.source]] in pyproject.toml : 1 2 3 4 [[tool.pdm.source]] url = \"https://private-site.org/pypi/simple\" verify_ssl = true name = \"internal\" This works as if --extra-index-url https://private-site.org/pypi/simple is passed. Or you can override the pypi.url value by using a source named pypi : 1 2 3 4 [[tool.pdm.source]] url = \"https://private.pypi.org/simple\" verify_ssl = true name = \"pypi\" Difference from changing config value When you want all packages to be fetched from the given index instead of the default one, despite what platform your are on or who is to deploy the app, write it in the [[tool.pdm.source]] . Otherwise if you would like to change the index temporarily on the current platform (for network reasons), you should use pdm config pypi.url https://private.pypi.org/simple .","title":"Specify other sources for finding packages"},{"location":"pyproject/tool-pdm/#include-and-exclude-package-files","text":"The way of specifying include and exclude files are simple, they are given as a list of glob patterns: 1 2 3 4 5 6 7 includes = [ \"**/*.json\" , \"mypackage/\" , ] excludes = [ \"mypackage/_temp/*\" ] In case you want some files to be included in sdist only, you use the source-includes field: 1 2 3 includes = [...] excludes = [...] source-includes = [\"tests/\"] Note that the files defined in source-includes will be excluded automatically from non-sdist builds.","title":"Include and exclude package files"},{"location":"pyproject/tool-pdm/#default-values-for-includes-and-excludes","text":"If you don't specify any of these fields, PDM also provides smart default values to fit the most common workflows. Top-level packages will be included. tests package will be excluded from non-sdist builds. src directory will be detected as the package-dir if it exists. If your project follows the above conventions you don't need to config any of these fields and it just works. Be awared PDM won't add PEP 420 implicit namespace packages automatically and they should always be specified in includes explicitly.","title":"Default values for includes and excludes"},{"location":"pyproject/tool-pdm/#select-another-package-directory-to-look-for-packages","text":"Similar to setuptools ' package_dir setting, one can specify another package directory, such as src , in pyproject.toml easily: 1 package-dir = \"src\" If no package directory is given, PDM can also recognize src as the package-dir implicitly if: src/__init__.py doesn't exist, meaning it is not a valid Python package, and There exist some packages under src/* .","title":"Select another package directory to look for packages"},{"location":"pyproject/tool-pdm/#implicit-namespace-packages","text":"As specified in PEP 420 , a directory will be recognized as a namespace package if: <package>/__init__.py doesn't exist, and There exist normal packages and/or other namespace packages under <package>/* , and <package> is explicitly listed in includes","title":"Implicit namespace packages"},{"location":"pyproject/tool-pdm/#build-c-extensions","text":"Currently, building C extensions still relies on setuptools . You should write a python script which contains a function named build and accepts the parameter dictionary of setup() as the only argument. Update the dictionary with your ext_modules settings in the function. Here is an example taken from MarkupSafe : 1 2 3 4 5 6 7 # build.py from setuptools import Extension ext_modules = [ Extension ( \"markupsafe._speedups\" , [ \"src/markupsafe/_speedups.c\" ])] def build ( setup_kwargs ): setup_kwargs . update ( ext_modules = ext_modules ) Now, specify the build script path via build in the pyproject.toml : 1 2 3 # pyproject.toml [tool.pdm] build = \"build.py\"","title":"Build C extensions"},{"location":"usage/advanced/","text":"Advanced Usage # Automatic Testing # Use Tox as the runner # Tox is a great tool for testing against multiple Python versions or dependency sets. You can configure a tox.ini like the following to integrate your testing with PDM: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [tox] env_list = py{36,37,38},lint isolated_build = true passenv = PDM_IGNORE_SAVED_PYTHON=1 [testenv] deps = pdm commands = pdm install --dev pytest tests [testenv:lint] deps = pdm commands = pdm install -s lint flake8 src/ To use the virtualenv created by Tox, you should make sure you have set pdm config use_venv true . PDM then will install dependencies from pdm.lock into the virtualenv. In the dedicated venv you can directly run tools by pytest tests/ instead of pdm run pytest tests/ . You should also make sure you don't run pdm add/pdm remove/pdm update/pdm lock in the test commands, otherwise the pdm.lock file will be modified unexpectedly. Additional dependencies can be supplied with the deps config. Besides, isolated_buid and passenv config should be set as the above example to make PDM work properly. To get rid of these constraints, there is a Tox plugin tox-pdm which can ease the usage. You can install it by 1 $ pip install tox-pdm Or, 1 $ pdm add --dev tox-pdm And you can make the tox.ini much tidier as following, : 1 2 3 4 5 6 7 8 9 10 11 12 [tox] env_list = py{36,37,38},lint [testenv] sections = dev commands = pytest tests [testenv:lint] sections = lint commands = flake8 src/ See the project's README for a detailed guidance. Use Nox as the runner # Nox is another great tool for automated testing. Unlike tox, Nox uses a standard Python file for configuration. It is much easier to use PDM in Nox, here is an example of noxfile.py : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import os import nox os . environ . update ({ \"PDM_IGNORE_SAVED_PYTHON\" : \"1\" }) @nox . session def tests ( session ): session . run ( 'pdm' , 'install' , '-s' , 'test' , external = True ) session . run ( 'pytest' ) @nox . session def lint ( session ): session . run ( 'pdm' , 'install' , '-s' , 'lint' , external = True ) session . run ( 'flake8' , '--import-order-style' , 'google' ) Note that PDM_IGNORE_SAVED_PYTHON should be set so that PDM can pick up the Python in the virtualenv correctly. Also make sure pdm is available in the PATH . Before running nox, you should also pdm config use_venv true to enable venv reusing. About PEP 582 __pypackages__ directory # By default, if you run tools by pdm run , __pypackages__ will be seen by the program and all subprocesses created by it. This means virtual environments created by those tools are also aware of the packages inside __pypackages__ , which result in unexpected behavior in some cases. For nox , you can avoid this by adding a line in noxfile.py : 1 os . environ . pop ( \"PYTHONPATH\" , None ) For tox , PYTHONPATH will not be passed to the test sessions so this isn't going to be a problem. Moreover, it is recommended to make nox and tox live in their own pipx environments so you don't need to install for every project. In this case, PEP 582 packages will not be a problem either. Use PDM in Continuous Integration # Only one thing to keep in mind -- PDM can't be installed on Python < 3.7, so if your project is to be tested on those Python versions, you have to make sure PDM is installed on the correct Python version, which can be different from the target Python version the particular job/task is run on. Fortunately, if you are using GitHub Action, there is pdm-project/setup-pdm to make this process easier. Here is an example workflow of GitHub Actions, while you can adapt it for other CI platforms. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Testing : runs-on : ${{ matrix.os }} strategy : matrix : python-version : [ 3.6 , 3.7 , 3.8 , 3.9 ] os : [ ubuntu-latest , macOS-latest , windows-latest ] steps : - uses : actions/checkout@v1 - name : Set up PDM uses : pdm-project/setup-pdm@main with : python-version : ${{ matrix.python-version }} - name : Install dependencies run : | pdm sync -d -s testing - name : Run Tests run : | pdm run -v pytest tests TIPS For GitHub Action users, there is a known compatibility issue on Ubuntu virtual environment. If PDM parallel install is failed on that machine you should either set parallel_install to false or set env LD_PRELOAD=/lib/x86_64-linux-gnu/libgcc_s.so.1 . It is already handled by the pdm-project/setup-pdm action. Note If your CI scripts run without a proper user set, you might get permission errors when PDM tries to create its cache directory. To work around this, you can set the HOME environment variable yourself, to a writable directory, for example: 1 export HOME = /tmp/home Use other PEP 517 backends # PDM supports ALL PEP 517 build backends that comply with PEP 621 specification. At the time of writing, flit is going to switch to PEP 621 metadata in the near future, then you can keep flit as the build-backend while still managing dependencies using PDM: 1 2 3 [build-system] requires = [\"flit_core >=2,<4\"] build-backend = \"flit_core.buildapi\" PDM will call the correct backend when pdm build . Use PDM in a multi-stage Dockerfile # It is possible to use PDM in a multi-stage Dockerfile to first install the project and dependencies into __pypackages__ and then copy this folder into the final stage, adding it to PYTHONPATH . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # build stage FROM python:3.8 AS builder # install PDM RUN pip install -U pip setuptools wheel RUN pip install pdm # copy files COPY pyproject.toml pdm.lock README.md /project/ COPY src/ /project/src # install dependencies and project WORKDIR /project RUN pdm install --prod --no-lock --no-editable # run stage FROM python:3.8 # retrieve packages from build stage ENV PYTHONPATH = /project/pkgs COPY --from = builder /project/__pypackages__/3.8/lib /project/pkgs # set command/entrypoint, adapt to fit your needs CMD [ \"python\" , \"-m\" , \"project\" ] Integrate with other IDE or editors # Work with lsp-python-ms in Emacs # Below is a sample code snippet showing how to make PDM work with lsp-python-ms in Emacs. Contributed by @linw1995 . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 ;; TODO: Cache result ( defun linw1995/pdm-get-python-executable ( &optional dir ) ( let (( pdm-get-python-cmd \"pdm info --python\" )) ( string-trim ( shell-command-to-string ( if dir ( concat \"cd \" dir \" && \" pdm-get-python-cmd ) pdm-get-python-cmd ))))) ( defun linw1995/pdm-get-packages-path ( &optional dir ) ( let (( pdm-get-packages-cmd \"pdm info --packages\" )) ( concat ( string-trim ( shell-command-to-string ( if dir ( concat \"cd \" dir \" && \" pdm-get-packages-cmd ) pdm-get-packages-cmd ))) \"/lib\" ))) ( use-package lsp-python-ms :ensure t :init ( setq lsp-python-ms-auto-install-server t ) :hook ( python-mode . ( lambda () ( setq lsp-python-ms-python-executable ( linw1995/pdm-get-python-executable )) ( setq lsp-python-ms-extra-paths ( vector ( linw1995/pdm-get-packages-path ))) ( require 'lsp-python-ms ) ( lsp )))) ; or lsp-deferred","title":"Advanced Usage"},{"location":"usage/advanced/#advanced-usage","text":"","title":"Advanced Usage"},{"location":"usage/advanced/#automatic-testing","text":"","title":"Automatic Testing"},{"location":"usage/advanced/#use-tox-as-the-runner","text":"Tox is a great tool for testing against multiple Python versions or dependency sets. You can configure a tox.ini like the following to integrate your testing with PDM: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [tox] env_list = py{36,37,38},lint isolated_build = true passenv = PDM_IGNORE_SAVED_PYTHON=1 [testenv] deps = pdm commands = pdm install --dev pytest tests [testenv:lint] deps = pdm commands = pdm install -s lint flake8 src/ To use the virtualenv created by Tox, you should make sure you have set pdm config use_venv true . PDM then will install dependencies from pdm.lock into the virtualenv. In the dedicated venv you can directly run tools by pytest tests/ instead of pdm run pytest tests/ . You should also make sure you don't run pdm add/pdm remove/pdm update/pdm lock in the test commands, otherwise the pdm.lock file will be modified unexpectedly. Additional dependencies can be supplied with the deps config. Besides, isolated_buid and passenv config should be set as the above example to make PDM work properly. To get rid of these constraints, there is a Tox plugin tox-pdm which can ease the usage. You can install it by 1 $ pip install tox-pdm Or, 1 $ pdm add --dev tox-pdm And you can make the tox.ini much tidier as following, : 1 2 3 4 5 6 7 8 9 10 11 12 [tox] env_list = py{36,37,38},lint [testenv] sections = dev commands = pytest tests [testenv:lint] sections = lint commands = flake8 src/ See the project's README for a detailed guidance.","title":"Use Tox as the runner"},{"location":"usage/advanced/#use-nox-as-the-runner","text":"Nox is another great tool for automated testing. Unlike tox, Nox uses a standard Python file for configuration. It is much easier to use PDM in Nox, here is an example of noxfile.py : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import os import nox os . environ . update ({ \"PDM_IGNORE_SAVED_PYTHON\" : \"1\" }) @nox . session def tests ( session ): session . run ( 'pdm' , 'install' , '-s' , 'test' , external = True ) session . run ( 'pytest' ) @nox . session def lint ( session ): session . run ( 'pdm' , 'install' , '-s' , 'lint' , external = True ) session . run ( 'flake8' , '--import-order-style' , 'google' ) Note that PDM_IGNORE_SAVED_PYTHON should be set so that PDM can pick up the Python in the virtualenv correctly. Also make sure pdm is available in the PATH . Before running nox, you should also pdm config use_venv true to enable venv reusing.","title":"Use Nox as the runner"},{"location":"usage/advanced/#about-pep-582-__pypackages__-directory","text":"By default, if you run tools by pdm run , __pypackages__ will be seen by the program and all subprocesses created by it. This means virtual environments created by those tools are also aware of the packages inside __pypackages__ , which result in unexpected behavior in some cases. For nox , you can avoid this by adding a line in noxfile.py : 1 os . environ . pop ( \"PYTHONPATH\" , None ) For tox , PYTHONPATH will not be passed to the test sessions so this isn't going to be a problem. Moreover, it is recommended to make nox and tox live in their own pipx environments so you don't need to install for every project. In this case, PEP 582 packages will not be a problem either.","title":"About PEP 582 __pypackages__ directory"},{"location":"usage/advanced/#use-pdm-in-continuous-integration","text":"Only one thing to keep in mind -- PDM can't be installed on Python < 3.7, so if your project is to be tested on those Python versions, you have to make sure PDM is installed on the correct Python version, which can be different from the target Python version the particular job/task is run on. Fortunately, if you are using GitHub Action, there is pdm-project/setup-pdm to make this process easier. Here is an example workflow of GitHub Actions, while you can adapt it for other CI platforms. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Testing : runs-on : ${{ matrix.os }} strategy : matrix : python-version : [ 3.6 , 3.7 , 3.8 , 3.9 ] os : [ ubuntu-latest , macOS-latest , windows-latest ] steps : - uses : actions/checkout@v1 - name : Set up PDM uses : pdm-project/setup-pdm@main with : python-version : ${{ matrix.python-version }} - name : Install dependencies run : | pdm sync -d -s testing - name : Run Tests run : | pdm run -v pytest tests TIPS For GitHub Action users, there is a known compatibility issue on Ubuntu virtual environment. If PDM parallel install is failed on that machine you should either set parallel_install to false or set env LD_PRELOAD=/lib/x86_64-linux-gnu/libgcc_s.so.1 . It is already handled by the pdm-project/setup-pdm action. Note If your CI scripts run without a proper user set, you might get permission errors when PDM tries to create its cache directory. To work around this, you can set the HOME environment variable yourself, to a writable directory, for example: 1 export HOME = /tmp/home","title":"Use PDM in Continuous Integration"},{"location":"usage/advanced/#use-other-pep-517-backends","text":"PDM supports ALL PEP 517 build backends that comply with PEP 621 specification. At the time of writing, flit is going to switch to PEP 621 metadata in the near future, then you can keep flit as the build-backend while still managing dependencies using PDM: 1 2 3 [build-system] requires = [\"flit_core >=2,<4\"] build-backend = \"flit_core.buildapi\" PDM will call the correct backend when pdm build .","title":"Use other PEP 517 backends"},{"location":"usage/advanced/#use-pdm-in-a-multi-stage-dockerfile","text":"It is possible to use PDM in a multi-stage Dockerfile to first install the project and dependencies into __pypackages__ and then copy this folder into the final stage, adding it to PYTHONPATH . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # build stage FROM python:3.8 AS builder # install PDM RUN pip install -U pip setuptools wheel RUN pip install pdm # copy files COPY pyproject.toml pdm.lock README.md /project/ COPY src/ /project/src # install dependencies and project WORKDIR /project RUN pdm install --prod --no-lock --no-editable # run stage FROM python:3.8 # retrieve packages from build stage ENV PYTHONPATH = /project/pkgs COPY --from = builder /project/__pypackages__/3.8/lib /project/pkgs # set command/entrypoint, adapt to fit your needs CMD [ \"python\" , \"-m\" , \"project\" ]","title":"Use PDM in a multi-stage Dockerfile"},{"location":"usage/advanced/#integrate-with-other-ide-or-editors","text":"","title":"Integrate with other IDE or editors"},{"location":"usage/advanced/#work-with-lsp-python-ms-in-emacs","text":"Below is a sample code snippet showing how to make PDM work with lsp-python-ms in Emacs. Contributed by @linw1995 . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 ;; TODO: Cache result ( defun linw1995/pdm-get-python-executable ( &optional dir ) ( let (( pdm-get-python-cmd \"pdm info --python\" )) ( string-trim ( shell-command-to-string ( if dir ( concat \"cd \" dir \" && \" pdm-get-python-cmd ) pdm-get-python-cmd ))))) ( defun linw1995/pdm-get-packages-path ( &optional dir ) ( let (( pdm-get-packages-cmd \"pdm info --packages\" )) ( concat ( string-trim ( shell-command-to-string ( if dir ( concat \"cd \" dir \" && \" pdm-get-packages-cmd ) pdm-get-packages-cmd ))) \"/lib\" ))) ( use-package lsp-python-ms :ensure t :init ( setq lsp-python-ms-auto-install-server t ) :hook ( python-mode . ( lambda () ( setq lsp-python-ms-python-executable ( linw1995/pdm-get-python-executable )) ( setq lsp-python-ms-extra-paths ( vector ( linw1995/pdm-get-packages-path ))) ( require 'lsp-python-ms ) ( lsp )))) ; or lsp-deferred","title":"Work with lsp-python-ms in Emacs"},{"location":"usage/dependency/","text":"Manage dependencies # PDM provides a bunch of handful commands to help manage your project and dependencies. The following examples are run on Ubuntu 18.04, a few changes must be done if you are using Windows. Initialize a project # 1 2 $ mkdir pdm-test && cd pdm-test $ pdm init Answer several questions asked by PDM and a pyproject.toml will be created for you in the project root: 1 2 3 4 5 6 7 8 9 10 11 [project] name = \"pdm-test\" version = \"0.0.0\" description = \"\" authors = [ { name = \"Frost Ming\" , email = \"mianghong@gmail.com\" } ] license = { text = \"MIT\" } requires-python = \">=3.7\" dependencies = [] If pyproject.toml is already present, it will be updated with the metadata. The metadata format follows the PEP 621 specification For details of the meaning of each field in pyproject.toml , please refer to Project File . Add dependencies # 1 $ pdm add requests pdm add can be followed by one or several dependencies, and the dependency specification is described in PEP 508 . PDM also allows extra dependency groups by providing -s/--section <name> option, and those dependencies will go to [project.optional-dependencies.<name>] table in the project file, respectively. After that, dependencies and sub-dependencies will be resolved properly and installed for you, you can view pdm.lock to see the resolved result of all dependencies. Local packages can be installed in editable mode (just like pip install -e <local project path> would) using pdm add -e/--editable <local project path> . Add development only dependencies # New in 1.5.0 PDM also supports defining groups of dependencies that are useful for development. They can be classified as different sections, e.g. some for testing and others for linting. We usually don't want these dependencies appear in the distribution's metadata so using optional-dependencies is probably not a good idea. We can define them as development dependencies: 1 $ pdm add -ds test pytest This will result in a pyproject.toml as following: 1 2 [tool.pdm.dev-dependencies] test = [\"pytest\"] For backward-compatibility, if -s/--section is not given, dependencies will go to dev group under [tool.pdm.dev-dependencies] by default. Note The same group name MUST NOT appear in both [tool.pdm.dev-dependencies] and [project.optional-dependencies] . Save version specifiers # If the package is given without a version specifier like pdm add requests . PDM provides three different behaviors of what version specifier is saved for the dependency, which is given by --save-<strategy> (Assume 2.21.0 is the latest version that can be found for the dependency): compatible : Save the compatible version specifier: >=2.21.0,<3.0.0 (default). exact : Save the exact version specifier: ==2.21.0 . wildcard : Don't constrain version and leave the specifier to be wildcard: * . Update existing dependencies # To update all dependencies in the lock file: 1 $ pdm update To update the specified package(s): 1 $ pdm update requests To update multiple sections of dependencies: 1 $ pdm update -s security -s http To update a given package in the specified section: 1 $ pdm update -s security cryptography If the section is not given, PDM will search for the requirement in the default dependencies set and raises an error if none is found. To update packages in development dependencies: 1 2 3 4 # Update all default + dev-dependencies $ pdm update -d # Update a package in the specified section of dev-dependencies $ pdm update -ds test pytest About update strategy # Similarly, PDM also provides 2 different behaviors of updating dependencies and sub-dependencies\uff0c which is given by --update-<strategy> option: reuse : Keep all locked dependencies except for those given in the command line. eager : Try to lock a newer version of the packages in command line and their recursive sub-dependencies and keep other dependencies as they are. Remove existing dependencies # To remove existing dependencies from project file and the library directory: 1 2 3 4 5 6 # Remove requests from the default dependencies $ pdm remove requests # Remove h11 from the 'web' section of optional-dependencies $ pdm remove -s web h11 # Remove pytest-cov from the ` test ` section of dev-dependencies $ pdm remove -ds test pytest-cov Install the packages pinned in lock file # There are two similar commands to do this job with a slight difference: pdm install will check the lock file and relock if it mismatches with project file, then install. pdm sync installs dependencies in the lock file and will error out if it doesn't exist. Besides, pdm sync can also remove unneeded packages if --clean option is given. Select a subset of dependencies with CLI options # Say we have a project with following dependencies: 1 2 3 4 5 6 7 8 9 10 [ project ] # This is production dependencies dependencies = [\"requests\"] [ project . optional-dependencies ] # This is optional dependencies extra1 = [\"flask\"] extra2 = [\"django\"] [ tool . pdm . dev-dependencies ] # This is dev dependencies dev1 = [\"pytest\"] dev2 = [\"mkdocs\"] Command What it does Comments pdm install install prod and dev deps (no optional) pdm install -s extra1 install prod deps, dev deps, and \"extra1\" optional section pdm install -s dev1 install prod deps and only \"dev1\" dev section pdm install -s:all install prod deps, dev deps and \"extra1\", \"extra2\" optional sections pdm install -s extra1 -s dev1 install prod deps, \"extra1\" optional section and only \"dev1\" dev section pdm install --prod install prod only pdm install --prod -s extra1 install prod deps and \"extra1\" optional pdm install --prod -s dev1 Fail, --prod can't be given with dev dependencies Leave the --prod option All development dependencies are included as long as --prod is not passed and -s doesn't specify any dev sections. Besides, if you don't want the root project to be installed, add --no-self option, and --no-editable can be used when you want all packages to be installed in non-editable versions. With --no-editable turn on, you can safely archive the whole __pypackages__ and copy it to the target environment for deployment. Show what packages are installed # Similar to pip list , you can list all packages installed in the packages directory: 1 $ pdm list Or show a dependency graph by: 1 2 3 4 5 6 7 8 9 10 11 12 $ pdm list --graph tempenv 0.0.0 \u2514\u2500\u2500 click 7.0 [ required: <7.0.0,>=6.7 ] black 19.10b0 \u251c\u2500\u2500 appdirs 1.4.3 [ required: Any ] \u251c\u2500\u2500 attrs 19.3.0 [ required: >=18.1.0 ] \u251c\u2500\u2500 click 7.0 [ required: >=6.5 ] \u251c\u2500\u2500 pathspec 0.7.0 [ required: <1,>=0.6 ] \u251c\u2500\u2500 regex 2020.2.20 [ required: Any ] \u251c\u2500\u2500 toml 0.10.0 [ required: >=0.9.4 ] \u2514\u2500\u2500 typed-ast 1.4.1 [ required: >=1.4.0 ] bump2version 1.0.0 Set PyPI index URL # You can specify a PyPI mirror URL by following commands: 1 $ pdm config pypi.url https://testpypi.org/simple By default, PDM will read the pip's configuration files to decide the PyPI URL, and fallback to https://pypi.org/simple if none is found. Allow prerelease versions to be installed # Include the following setting in pyproject.toml to enable: 1 2 [tool.pdm] allow_prereleases = true Environment variables expansion # For convenience, PDM supports environment variables expansion in the dependency specification under some circumstances: Environment variables in the URL auth part will be expanded: https://${USERNAME}:${PASSWORD}/artifacts.io/Flask-1.1.2.tar.gz . It is also okay to not give the auth part in the URL directly, PDM will ask for them when -v/--verbose is on. ${PROJECT_ROOT} will be expanded with the absolute path of the project root, in POSIX style(i.e. forward slash / , even on Windows). For consistency, URLs that refer to a local path under ${PROJECT_ROOT} must start with file:/// (three slashes), e.g. file:///${PROJECT_ROOT}/artifacts/Flask-1.1.2.tar.gz . Don't worry about credential leakage, the environment variables will be expanded when needed and kept untouched in the lock file.","title":"Manage Dependencies"},{"location":"usage/dependency/#manage-dependencies","text":"PDM provides a bunch of handful commands to help manage your project and dependencies. The following examples are run on Ubuntu 18.04, a few changes must be done if you are using Windows.","title":"Manage dependencies"},{"location":"usage/dependency/#initialize-a-project","text":"1 2 $ mkdir pdm-test && cd pdm-test $ pdm init Answer several questions asked by PDM and a pyproject.toml will be created for you in the project root: 1 2 3 4 5 6 7 8 9 10 11 [project] name = \"pdm-test\" version = \"0.0.0\" description = \"\" authors = [ { name = \"Frost Ming\" , email = \"mianghong@gmail.com\" } ] license = { text = \"MIT\" } requires-python = \">=3.7\" dependencies = [] If pyproject.toml is already present, it will be updated with the metadata. The metadata format follows the PEP 621 specification For details of the meaning of each field in pyproject.toml , please refer to Project File .","title":"Initialize a project"},{"location":"usage/dependency/#add-dependencies","text":"1 $ pdm add requests pdm add can be followed by one or several dependencies, and the dependency specification is described in PEP 508 . PDM also allows extra dependency groups by providing -s/--section <name> option, and those dependencies will go to [project.optional-dependencies.<name>] table in the project file, respectively. After that, dependencies and sub-dependencies will be resolved properly and installed for you, you can view pdm.lock to see the resolved result of all dependencies. Local packages can be installed in editable mode (just like pip install -e <local project path> would) using pdm add -e/--editable <local project path> .","title":"Add dependencies"},{"location":"usage/dependency/#add-development-only-dependencies","text":"New in 1.5.0 PDM also supports defining groups of dependencies that are useful for development. They can be classified as different sections, e.g. some for testing and others for linting. We usually don't want these dependencies appear in the distribution's metadata so using optional-dependencies is probably not a good idea. We can define them as development dependencies: 1 $ pdm add -ds test pytest This will result in a pyproject.toml as following: 1 2 [tool.pdm.dev-dependencies] test = [\"pytest\"] For backward-compatibility, if -s/--section is not given, dependencies will go to dev group under [tool.pdm.dev-dependencies] by default. Note The same group name MUST NOT appear in both [tool.pdm.dev-dependencies] and [project.optional-dependencies] .","title":"Add development only dependencies"},{"location":"usage/dependency/#save-version-specifiers","text":"If the package is given without a version specifier like pdm add requests . PDM provides three different behaviors of what version specifier is saved for the dependency, which is given by --save-<strategy> (Assume 2.21.0 is the latest version that can be found for the dependency): compatible : Save the compatible version specifier: >=2.21.0,<3.0.0 (default). exact : Save the exact version specifier: ==2.21.0 . wildcard : Don't constrain version and leave the specifier to be wildcard: * .","title":"Save version specifiers"},{"location":"usage/dependency/#update-existing-dependencies","text":"To update all dependencies in the lock file: 1 $ pdm update To update the specified package(s): 1 $ pdm update requests To update multiple sections of dependencies: 1 $ pdm update -s security -s http To update a given package in the specified section: 1 $ pdm update -s security cryptography If the section is not given, PDM will search for the requirement in the default dependencies set and raises an error if none is found. To update packages in development dependencies: 1 2 3 4 # Update all default + dev-dependencies $ pdm update -d # Update a package in the specified section of dev-dependencies $ pdm update -ds test pytest","title":"Update existing dependencies"},{"location":"usage/dependency/#about-update-strategy","text":"Similarly, PDM also provides 2 different behaviors of updating dependencies and sub-dependencies\uff0c which is given by --update-<strategy> option: reuse : Keep all locked dependencies except for those given in the command line. eager : Try to lock a newer version of the packages in command line and their recursive sub-dependencies and keep other dependencies as they are.","title":"About update strategy"},{"location":"usage/dependency/#remove-existing-dependencies","text":"To remove existing dependencies from project file and the library directory: 1 2 3 4 5 6 # Remove requests from the default dependencies $ pdm remove requests # Remove h11 from the 'web' section of optional-dependencies $ pdm remove -s web h11 # Remove pytest-cov from the ` test ` section of dev-dependencies $ pdm remove -ds test pytest-cov","title":"Remove existing dependencies"},{"location":"usage/dependency/#install-the-packages-pinned-in-lock-file","text":"There are two similar commands to do this job with a slight difference: pdm install will check the lock file and relock if it mismatches with project file, then install. pdm sync installs dependencies in the lock file and will error out if it doesn't exist. Besides, pdm sync can also remove unneeded packages if --clean option is given.","title":"Install the packages pinned in lock file"},{"location":"usage/dependency/#select-a-subset-of-dependencies-with-cli-options","text":"Say we have a project with following dependencies: 1 2 3 4 5 6 7 8 9 10 [ project ] # This is production dependencies dependencies = [\"requests\"] [ project . optional-dependencies ] # This is optional dependencies extra1 = [\"flask\"] extra2 = [\"django\"] [ tool . pdm . dev-dependencies ] # This is dev dependencies dev1 = [\"pytest\"] dev2 = [\"mkdocs\"] Command What it does Comments pdm install install prod and dev deps (no optional) pdm install -s extra1 install prod deps, dev deps, and \"extra1\" optional section pdm install -s dev1 install prod deps and only \"dev1\" dev section pdm install -s:all install prod deps, dev deps and \"extra1\", \"extra2\" optional sections pdm install -s extra1 -s dev1 install prod deps, \"extra1\" optional section and only \"dev1\" dev section pdm install --prod install prod only pdm install --prod -s extra1 install prod deps and \"extra1\" optional pdm install --prod -s dev1 Fail, --prod can't be given with dev dependencies Leave the --prod option All development dependencies are included as long as --prod is not passed and -s doesn't specify any dev sections. Besides, if you don't want the root project to be installed, add --no-self option, and --no-editable can be used when you want all packages to be installed in non-editable versions. With --no-editable turn on, you can safely archive the whole __pypackages__ and copy it to the target environment for deployment.","title":"Select a subset of dependencies with CLI options"},{"location":"usage/dependency/#show-what-packages-are-installed","text":"Similar to pip list , you can list all packages installed in the packages directory: 1 $ pdm list Or show a dependency graph by: 1 2 3 4 5 6 7 8 9 10 11 12 $ pdm list --graph tempenv 0.0.0 \u2514\u2500\u2500 click 7.0 [ required: <7.0.0,>=6.7 ] black 19.10b0 \u251c\u2500\u2500 appdirs 1.4.3 [ required: Any ] \u251c\u2500\u2500 attrs 19.3.0 [ required: >=18.1.0 ] \u251c\u2500\u2500 click 7.0 [ required: >=6.5 ] \u251c\u2500\u2500 pathspec 0.7.0 [ required: <1,>=0.6 ] \u251c\u2500\u2500 regex 2020.2.20 [ required: Any ] \u251c\u2500\u2500 toml 0.10.0 [ required: >=0.9.4 ] \u2514\u2500\u2500 typed-ast 1.4.1 [ required: >=1.4.0 ] bump2version 1.0.0","title":"Show what packages are installed"},{"location":"usage/dependency/#set-pypi-index-url","text":"You can specify a PyPI mirror URL by following commands: 1 $ pdm config pypi.url https://testpypi.org/simple By default, PDM will read the pip's configuration files to decide the PyPI URL, and fallback to https://pypi.org/simple if none is found.","title":"Set PyPI index URL"},{"location":"usage/dependency/#allow-prerelease-versions-to-be-installed","text":"Include the following setting in pyproject.toml to enable: 1 2 [tool.pdm] allow_prereleases = true","title":"Allow prerelease versions to be installed"},{"location":"usage/dependency/#environment-variables-expansion","text":"For convenience, PDM supports environment variables expansion in the dependency specification under some circumstances: Environment variables in the URL auth part will be expanded: https://${USERNAME}:${PASSWORD}/artifacts.io/Flask-1.1.2.tar.gz . It is also okay to not give the auth part in the URL directly, PDM will ask for them when -v/--verbose is on. ${PROJECT_ROOT} will be expanded with the absolute path of the project root, in POSIX style(i.e. forward slash / , even on Windows). For consistency, URLs that refer to a local path under ${PROJECT_ROOT} must start with file:/// (three slashes), e.g. file:///${PROJECT_ROOT}/artifacts/Flask-1.1.2.tar.gz . Don't worry about credential leakage, the environment variables will be expanded when needed and kept untouched in the lock file.","title":"Environment variables expansion"},{"location":"usage/project/","text":"Manage project # PDM can act as a PEP 517 build backend, to enable that, write the following lines in your pyproject.toml . If you used pdm init to create it for you, it should be done already. 1 2 3 [build-system] requires = [\"pdm-pep517\"] build-backend = \"pdm.pep517.api\" pip will read the backend settings to install or build a package. Choose a Python interpreter # If you have used pdm init , you must have already seen how PDM detects and selects the Python interpreter. After initialized, you can also change the settings by pdm use <python_version_or_path> . The argument can be either a version specifier of any length, or a relative or absolute path to the python interpreter, but remember the Python interpreter must conform with the python_requires constraint in the project file. How requires-python controls the project # PDM respects the value of requires-python in the way that it tries to pick package candidates that can work on all python versions that requires-python contains. For example, if requires-python is >=2.7 , PDM will try to find the latest version of foo , whose requires-python version range is a superset of >=2.7 . So, make sure you write requires-python properly if you don't want any outdated packages to be locked. Build distribution artifacts # 1 2 3 4 5 $ pdm build - Building sdist... - Built pdm-test-0.0.0.tar.gz - Building wheel... - Built pdm_test-0.0.0-py3-none-any.whl The artifacts can then be uploaded to PyPI by twine . Available options can be found by typing pdm build --help . Show the current Python environment # 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $ pdm info Python Interpreter: D:/Programs/Python/Python38/python.exe (3.8.0) Project Root: D:/Workspace/pdm [10:42] $ pdm info --env { \"implementation_name\": \"cpython\", \"implementation_version\": \"3.8.0\", \"os_name\": \"nt\", \"platform_machine\": \"AMD64\", \"platform_release\": \"10\", \"platform_system\": \"Windows\", \"platform_version\": \"10.0.18362\", \"python_full_version\": \"3.8.0\", \"platform_python_implementaiton\": \"CPython\", \"python_version\": \"3.8\", \"sys_platform\": \"win32\" } Configure the project # PDM's config command works just like git config , except that --list isn't needed to show configurations. Show the current configurations: 1 $ pdm config Get one single configuration: 1 $ pdm config pypi.url Change a configuration value and store in home configuration: 1 $ pdm config pypi.url \"https://testpypi.org/simple\" By default, the configuration are changed globally, if you want to make the config seen by this project only, add a --local flag: 1 $ pdm config --local pypi.url \"https://testpypi.org/simple\" Any local configurations will be stored in .pdm.toml under the project root directory. The configuration files are searched in the following order: <PROJECT_ROOT>/.pdm.toml - The project configuration ~/.pdm/config.toml - The home configuration If -g/--global option is used, the first item will be replaced by ~/.pdm/global-project/.pdm.toml . You can find all available configuration items in Configuration Page . Manage global project # Sometimes users may want to keep track of the dependencies of global Python interpreter as well. It is easy to do so with PDM, via -g/--global option which is supported by most subcommands. If the option is passed, ~/.pdm/global-project will be used as the project directory, which is almost the same as normal project except that pyproject.toml will be created automatically for you and it doesn't support build features. The idea is taken from Haskell's stack . However, unlike stack , by default, PDM won't use global project automatically if a local project is not found. Users should pass -g/--global explicitly to activate it, since it is not very pleasing if packages go to a wrong place. But PDM also leave the decision to users, just set the config auto_global to true . If you want global project to track another project file other than ~/.pdm/global-project , you can provide the project path via -p/--project <path> option. CAUTION Be careful with remove and sync --clean commands when global project is used, because it may remove packages installed in your system Python. Working with a virtualenv # Although PDM enforces PEP 582 by default, it also allows users to install packages into the virtualenv. It is controlled by the configuration item use_venv . When it is set to True PDM will use the virtualenv if: a virtualenv is already activated. any of venv , .venv , env is a valid virtualenv folder. Besides, when use-venv is on and the interpreter path given is a venv-like path, PDM will reuse that venv directory as well. For enhanced virtualenv support such as virtualenv management and auto-creation, please go for pdm-venv , which can be installed as a plugin. Import project metadata from existing project files # If you are already other package manager tools like Pipenv or Poetry, it is easy to migrate to PDM. PDM provides import command so that you don't have to initialize the project manually, it now supports: Pipenv's Pipfile Poetry's section in pyproject.toml Flit's section in pyproject.toml requirements.txt format used by Pip Also, when you are executing pdm init or pdm install , PDM can auto-detect possible files to import if your PDM project has not been initialized yet. Export locked packages to alternative formats # You can also export pdm.lock to other formats, to ease the CI flow or image building process. Currently, only requirements.txt and setup.py format is supported: 1 2 $ pdm export -o requirements.txt $ pdm export -f setuppy -o setup.py Hide the credentials from pyproject.toml # There are many times when we need to use sensitive information, such as login credentials for the PyPI server and username passwords for VCS repositories. We do not want to expose this information in pyproject.toml and upload it to git. PDM provides several methods to achieve this: User can give the auth information with environment variables which are encoded in the URL directly: 1 2 3 4 5 6 7 8 9 [[tool.pdm.source]] url = \"http://${INDEX_USER}:${INDEX_PASSWD}@test.pypi.org/simple\" name = \"test\" verify_ssl = false [project] dependencies = [ \"mypackage @ git+http://${VCS_USER}:${VCS_PASSWD}@test.git.com/test/mypackage.git@master\" ] Environment variables must be encoded in the form ${ENV_NAME} , other forms are not supported. Besides, only auth part will be expanded. If the credentials are not provided in the URL and a 401 response is received from the server, PDM will prompt for username and password when -v/--verbose is passed as command line argument, otherwise PDM will fail with an error telling users what happens. Users can then choose to store the credentials in the keyring after a confirmation question. A VCS repository applies the first method only, and an index server applies both methods. Run Scripts in Isolated Environment # With PDM, you can run arbitrary scripts or commands with local packages loaded: 1 $ pdm run flask run -p 54321 PDM also supports custom script shortcuts in the optional [tool.pdm.scripts] section of pyproject.toml . You can then run pdm run <shortcut_name> to invoke the script in the context of your PDM project. For example: 1 2 [tool.pdm.scripts] start_server = \"flask run -p 54321\" And then in your terminal: 1 2 $ pdm run start_server Flask server started at http://127.0.0.1:54321 Any extra arguments will be appended to the command: 1 2 $ pdm run start_server -h 0 .0.0.0 Flask server started at http://0.0.0.0:54321 PDM supports 3 types of scripts: Normal command # Plain text scripts are regarded as normal command, or you can explicitly specify it: 1 2 [tool.pdm.scripts] start_server = { cmd = \"flask run -p 54321\" } In some cases, such as when wanting to add comments between parameters, it might be more convinient to specify the command as an array instead of a string: 1 2 3 4 5 6 7 [tool.pdm.scripts] start_server = { cmd = [ \"flask\" , \"run\" , # Important comment here about always using port 54321 \"-p\" , \"54321\" ]} Shell script # Shell scripts can be used to run more shell-specific tasks, such as pipeline and output redirecting. This is basically run via subprocess.Popen() with shell=True : 1 2 [tool.pdm.scripts] filter_error = { shell = \"cat error.log|grep CRITICAL > critical.log\" } Call a Python function # The script can be also defined as calling a python function in the form <module_name>:<func_name> : 1 2 [tool.pdm.scripts] foobar = { call = \"foo_package.bar_module:main\" } The function can be supplied with literal arguments: 1 2 [tool.pdm.scripts] foobar = { call = \"foo_package.bar_module:main('dev')\" } Environment variables support # All environment variables set in the current shell can be seen by pdm run and will be expanded when executed. Besides, you can also define some fixed environment variables in your pyproject.toml : 1 2 3 [tool.pdm.scripts] start_server . cmd = \"flask run -p 54321\" start_server . env = { FOO = \"bar\" , FLASK_ENV = \"development\" } Note how we use TOML's syntax to define a compound dictionary. A dotenv file is also supported via env_file = \"<file_path>\" setting. For environment variables and/or dotenv file shared by all scripts, you can define env and env_file settings under a special key named _ of tool.pdm.scripts table: 1 2 3 4 [tool.pdm.scripts] _ . env_file = \".env\" start_server = \"flask run -p 54321\" migrate_db = \"flask db upgrade\" Besides, PDM also injects the root path of the project via PDM_PROJECT_ROOT environment variable. Show the list of scripts shortcuts # Use pdm run --list/-l to show the list of available script shortcuts: 1 2 3 4 5 6 $ pdm run --list Name Type Script Description ----------- ----- ---------------- ---------------------- test_cmd cmd flask db upgrade test_script call test_script:main call a python function test_shell shell echo $FOO shell command You can add an help option with the description of the script, and it will be displayed in the Description column in the above output. Manage caches # PDM provides a convenient command group to manage the cache, there are four kinds of caches: wheels/ stores the built results of non-wheel distributions and files. http/ stores the HTTP response content. metadata/ stores package metadata retreived by the resolver. hashes/ stores the file hashes fetched from the package index or calculated locally. See the current cache usage by typing pdm cache info . Besides, you can use add , remove and list subcommands to manage the cache content. Find the usage by the --help option of each command. How we make PEP 582 packages available to the Python interpreter # Thanks to the site packages loading on Python startup. It is possible to patch the sys.path by executing the sitecustomize.py shipped with PDM. The interpreter can search the directories for the nearest __pypackage__ folder and append it to the sys.path variable.","title":"Manage Project"},{"location":"usage/project/#manage-project","text":"PDM can act as a PEP 517 build backend, to enable that, write the following lines in your pyproject.toml . If you used pdm init to create it for you, it should be done already. 1 2 3 [build-system] requires = [\"pdm-pep517\"] build-backend = \"pdm.pep517.api\" pip will read the backend settings to install or build a package.","title":"Manage project"},{"location":"usage/project/#choose-a-python-interpreter","text":"If you have used pdm init , you must have already seen how PDM detects and selects the Python interpreter. After initialized, you can also change the settings by pdm use <python_version_or_path> . The argument can be either a version specifier of any length, or a relative or absolute path to the python interpreter, but remember the Python interpreter must conform with the python_requires constraint in the project file.","title":"Choose a Python interpreter"},{"location":"usage/project/#how-requires-python-controls-the-project","text":"PDM respects the value of requires-python in the way that it tries to pick package candidates that can work on all python versions that requires-python contains. For example, if requires-python is >=2.7 , PDM will try to find the latest version of foo , whose requires-python version range is a superset of >=2.7 . So, make sure you write requires-python properly if you don't want any outdated packages to be locked.","title":"How requires-python controls the project"},{"location":"usage/project/#build-distribution-artifacts","text":"1 2 3 4 5 $ pdm build - Building sdist... - Built pdm-test-0.0.0.tar.gz - Building wheel... - Built pdm_test-0.0.0-py3-none-any.whl The artifacts can then be uploaded to PyPI by twine . Available options can be found by typing pdm build --help .","title":"Build distribution artifacts"},{"location":"usage/project/#show-the-current-python-environment","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $ pdm info Python Interpreter: D:/Programs/Python/Python38/python.exe (3.8.0) Project Root: D:/Workspace/pdm [10:42] $ pdm info --env { \"implementation_name\": \"cpython\", \"implementation_version\": \"3.8.0\", \"os_name\": \"nt\", \"platform_machine\": \"AMD64\", \"platform_release\": \"10\", \"platform_system\": \"Windows\", \"platform_version\": \"10.0.18362\", \"python_full_version\": \"3.8.0\", \"platform_python_implementaiton\": \"CPython\", \"python_version\": \"3.8\", \"sys_platform\": \"win32\" }","title":"Show the current Python environment"},{"location":"usage/project/#configure-the-project","text":"PDM's config command works just like git config , except that --list isn't needed to show configurations. Show the current configurations: 1 $ pdm config Get one single configuration: 1 $ pdm config pypi.url Change a configuration value and store in home configuration: 1 $ pdm config pypi.url \"https://testpypi.org/simple\" By default, the configuration are changed globally, if you want to make the config seen by this project only, add a --local flag: 1 $ pdm config --local pypi.url \"https://testpypi.org/simple\" Any local configurations will be stored in .pdm.toml under the project root directory. The configuration files are searched in the following order: <PROJECT_ROOT>/.pdm.toml - The project configuration ~/.pdm/config.toml - The home configuration If -g/--global option is used, the first item will be replaced by ~/.pdm/global-project/.pdm.toml . You can find all available configuration items in Configuration Page .","title":"Configure the project"},{"location":"usage/project/#manage-global-project","text":"Sometimes users may want to keep track of the dependencies of global Python interpreter as well. It is easy to do so with PDM, via -g/--global option which is supported by most subcommands. If the option is passed, ~/.pdm/global-project will be used as the project directory, which is almost the same as normal project except that pyproject.toml will be created automatically for you and it doesn't support build features. The idea is taken from Haskell's stack . However, unlike stack , by default, PDM won't use global project automatically if a local project is not found. Users should pass -g/--global explicitly to activate it, since it is not very pleasing if packages go to a wrong place. But PDM also leave the decision to users, just set the config auto_global to true . If you want global project to track another project file other than ~/.pdm/global-project , you can provide the project path via -p/--project <path> option. CAUTION Be careful with remove and sync --clean commands when global project is used, because it may remove packages installed in your system Python.","title":"Manage global project"},{"location":"usage/project/#working-with-a-virtualenv","text":"Although PDM enforces PEP 582 by default, it also allows users to install packages into the virtualenv. It is controlled by the configuration item use_venv . When it is set to True PDM will use the virtualenv if: a virtualenv is already activated. any of venv , .venv , env is a valid virtualenv folder. Besides, when use-venv is on and the interpreter path given is a venv-like path, PDM will reuse that venv directory as well. For enhanced virtualenv support such as virtualenv management and auto-creation, please go for pdm-venv , which can be installed as a plugin.","title":"Working with a virtualenv"},{"location":"usage/project/#import-project-metadata-from-existing-project-files","text":"If you are already other package manager tools like Pipenv or Poetry, it is easy to migrate to PDM. PDM provides import command so that you don't have to initialize the project manually, it now supports: Pipenv's Pipfile Poetry's section in pyproject.toml Flit's section in pyproject.toml requirements.txt format used by Pip Also, when you are executing pdm init or pdm install , PDM can auto-detect possible files to import if your PDM project has not been initialized yet.","title":"Import project metadata from existing project files"},{"location":"usage/project/#export-locked-packages-to-alternative-formats","text":"You can also export pdm.lock to other formats, to ease the CI flow or image building process. Currently, only requirements.txt and setup.py format is supported: 1 2 $ pdm export -o requirements.txt $ pdm export -f setuppy -o setup.py","title":"Export locked packages to alternative formats"},{"location":"usage/project/#hide-the-credentials-from-pyprojecttoml","text":"There are many times when we need to use sensitive information, such as login credentials for the PyPI server and username passwords for VCS repositories. We do not want to expose this information in pyproject.toml and upload it to git. PDM provides several methods to achieve this: User can give the auth information with environment variables which are encoded in the URL directly: 1 2 3 4 5 6 7 8 9 [[tool.pdm.source]] url = \"http://${INDEX_USER}:${INDEX_PASSWD}@test.pypi.org/simple\" name = \"test\" verify_ssl = false [project] dependencies = [ \"mypackage @ git+http://${VCS_USER}:${VCS_PASSWD}@test.git.com/test/mypackage.git@master\" ] Environment variables must be encoded in the form ${ENV_NAME} , other forms are not supported. Besides, only auth part will be expanded. If the credentials are not provided in the URL and a 401 response is received from the server, PDM will prompt for username and password when -v/--verbose is passed as command line argument, otherwise PDM will fail with an error telling users what happens. Users can then choose to store the credentials in the keyring after a confirmation question. A VCS repository applies the first method only, and an index server applies both methods.","title":"Hide the credentials from pyproject.toml"},{"location":"usage/project/#run-scripts-in-isolated-environment","text":"With PDM, you can run arbitrary scripts or commands with local packages loaded: 1 $ pdm run flask run -p 54321 PDM also supports custom script shortcuts in the optional [tool.pdm.scripts] section of pyproject.toml . You can then run pdm run <shortcut_name> to invoke the script in the context of your PDM project. For example: 1 2 [tool.pdm.scripts] start_server = \"flask run -p 54321\" And then in your terminal: 1 2 $ pdm run start_server Flask server started at http://127.0.0.1:54321 Any extra arguments will be appended to the command: 1 2 $ pdm run start_server -h 0 .0.0.0 Flask server started at http://0.0.0.0:54321 PDM supports 3 types of scripts:","title":"Run Scripts in Isolated Environment"},{"location":"usage/project/#normal-command","text":"Plain text scripts are regarded as normal command, or you can explicitly specify it: 1 2 [tool.pdm.scripts] start_server = { cmd = \"flask run -p 54321\" } In some cases, such as when wanting to add comments between parameters, it might be more convinient to specify the command as an array instead of a string: 1 2 3 4 5 6 7 [tool.pdm.scripts] start_server = { cmd = [ \"flask\" , \"run\" , # Important comment here about always using port 54321 \"-p\" , \"54321\" ]}","title":"Normal command"},{"location":"usage/project/#shell-script","text":"Shell scripts can be used to run more shell-specific tasks, such as pipeline and output redirecting. This is basically run via subprocess.Popen() with shell=True : 1 2 [tool.pdm.scripts] filter_error = { shell = \"cat error.log|grep CRITICAL > critical.log\" }","title":"Shell script"},{"location":"usage/project/#call-a-python-function","text":"The script can be also defined as calling a python function in the form <module_name>:<func_name> : 1 2 [tool.pdm.scripts] foobar = { call = \"foo_package.bar_module:main\" } The function can be supplied with literal arguments: 1 2 [tool.pdm.scripts] foobar = { call = \"foo_package.bar_module:main('dev')\" }","title":"Call a Python function"},{"location":"usage/project/#environment-variables-support","text":"All environment variables set in the current shell can be seen by pdm run and will be expanded when executed. Besides, you can also define some fixed environment variables in your pyproject.toml : 1 2 3 [tool.pdm.scripts] start_server . cmd = \"flask run -p 54321\" start_server . env = { FOO = \"bar\" , FLASK_ENV = \"development\" } Note how we use TOML's syntax to define a compound dictionary. A dotenv file is also supported via env_file = \"<file_path>\" setting. For environment variables and/or dotenv file shared by all scripts, you can define env and env_file settings under a special key named _ of tool.pdm.scripts table: 1 2 3 4 [tool.pdm.scripts] _ . env_file = \".env\" start_server = \"flask run -p 54321\" migrate_db = \"flask db upgrade\" Besides, PDM also injects the root path of the project via PDM_PROJECT_ROOT environment variable.","title":"Environment variables support"},{"location":"usage/project/#show-the-list-of-scripts-shortcuts","text":"Use pdm run --list/-l to show the list of available script shortcuts: 1 2 3 4 5 6 $ pdm run --list Name Type Script Description ----------- ----- ---------------- ---------------------- test_cmd cmd flask db upgrade test_script call test_script:main call a python function test_shell shell echo $FOO shell command You can add an help option with the description of the script, and it will be displayed in the Description column in the above output.","title":"Show the list of scripts shortcuts"},{"location":"usage/project/#manage-caches","text":"PDM provides a convenient command group to manage the cache, there are four kinds of caches: wheels/ stores the built results of non-wheel distributions and files. http/ stores the HTTP response content. metadata/ stores package metadata retreived by the resolver. hashes/ stores the file hashes fetched from the package index or calculated locally. See the current cache usage by typing pdm cache info . Besides, you can use add , remove and list subcommands to manage the cache content. Find the usage by the --help option of each command.","title":"Manage caches"},{"location":"usage/project/#how-we-make-pep-582-packages-available-to-the-python-interpreter","text":"Thanks to the site packages loading on Python startup. It is possible to patch the sys.path by executing the sitecustomize.py shipped with PDM. The interpreter can search the directories for the nearest __pypackage__ folder and append it to the sys.path variable.","title":"How we make PEP 582 packages available to the Python interpreter"}]}